<meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>
<html lang="sw">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GideonBooking - Mfumo wa Kukata Tiketi</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
     * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f3f4fa;
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }   
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 100px 15px 20px;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 5px;
            width: 100%;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1000;
            background-color: rgba(26, 35, 126, 0.98);
            backdrop-filter: blur(10px);
            border-bottom: 2px solid #ffd700;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            flex-wrap: wrap;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo-icon {
            color: #ffd700;
            font-size: 1.8rem;
        }
        
        .header-left h1 {
            font-size: 1.4rem;
            color: white;
            white-space: nowrap;
        }
        
        .header-left h1 span:nth-child(2) {
            color: #ffd700;
        }
        
        .system-subtitle {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.8);
            margin-top: 2px;
            font-weight: normal;
        }
        
        /* Marekebisho ya kitufe cha lugha kwa simu */
        .language-toggle {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .language-toggle:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }
        
        .language-switcher {
            position: relative;
            display: flex;
            gap: 5px;
            z-index: 20;
        }
        
        .lang-btn {
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            backdrop-filter: blur(5px);
            white-space: nowrap;
            display: none;
        }
        
        .lang-btn.mobile-visible {
            display: inline-block;
        }
        
        .lang-btn.active {
            background: #ffd700;
            color: #1a237e;
            font-weight: 600;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        /* Marekebisho ya kwa simu - language dropdown */
        .mobile-language-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            background: rgba(26, 35, 126, 0.98);
            border-radius: 10px;
            padding: 10px;
            margin-top: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            z-index: 100;
            min-width: 160px;
            animation: slideDown 0.3s ease;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .mobile-language-dropdown.show {
            display: block;
        }
        
        .mobile-lang-btn {
            background: transparent;
            border: none;
            color: white;
            padding: 10px 15px;
            width: 100%;
            text-align: left;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.95rem;
        }
        
        .mobile-lang-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .mobile-lang-btn.active {
            background: #ffd700;
            color: #1a237e;
            font-weight: 600;
        }
        
        /* MAREKEBISHO YA 3: Nav za types of transport kwenye simu */
        .transport-options {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .transport-btn {
            padding: 10px 20px;
            font-size: 1rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-weight: 600;
            background-color: white;
            color: #1a237e;
            position: relative;
            overflow: hidden;
            min-width: 100px;
            flex: 1;
            max-width: 180px;
            text-align: center;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
        }
        
        .transport-btn i {
            font-size: 1.2rem;
        }
        
        /* MAREKEBISHO YA 3: Kwa simu */
       /* MAREKEBISHO YA 2: Matokeo ya safari kwa simu - kimstatili */
@media (max-width: 768px) {
    .transport-options-grid {
        grid-template-columns: 1fr;
        gap: 15px;
    }
    
    .transport-option-card {
        margin: 0 auto;
        max-width: 100%;
        display: flex;
        flex-direction: column;
    }
    
    /* HEADER - Logo na namba ya safari */
    .option-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 15px;
        background: #f8f9fa;
        border-bottom: 1px solid #eee;
        flex-wrap: nowrap;
    }
    
    .company-info {
        display: flex;
        align-items: center;
        gap: 10px;
        flex: 1;
    }
    
    .company-logo {
        width: 20px;
        height: 10px;
        min-width: 20px;
        border-radius: 0px;
        background: white;
       /* border: 1px solid #e0e0e0;*/
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
    }
    
    /*company-logo-img {
        width: 100%;
        height: 100%;
       /* object-fit: contain;
        padding: 5px;
    }*/
    
    .company-logo-text {
        font-size: 10px;
        text-align: center;
        color: #333;
        font-weight: bold;
        padding: 0 3px;
    }
    
    .company-name {
        font-weight: 600;
        color: #1a237e;
        font-size: 0.9rem;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    
    .option-number {
        font-weight: bold;
        color: #1a237e;
        font-size: 0.85rem;
        background: #e3f2fd;
        padding: 4px 10px;
        border-radius: 15px;
        white-space: nowrap;
    }
    
    /* BODY - Maelezo ya safari */
    .option-body {
        display: grid;
        grid-template-columns: 1fr auto 1fr;
        padding: 15px;
        gap: 10px;
        align-items: center;
        border-bottom: 1px solid #eee;
    }
    
    .option-departure, .option-arrival {
        text-align: center;
        padding: 5px;
    }
    
    .option-time {
        font-size: 1.4rem;
        font-weight: bold;
        margin: 5px 0;
        color: #1a237e;
    }
    
    .option-city {
        font-size: 0.95rem;
        color: #636e72;
        margin-bottom: 5px;
        font-weight: 600;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    
    .option-date {
        font-size: 0.8rem;
        color: #636e72;
        background: #f8f9fa;
        padding: 3px 8px;
        border-radius: 10px;
        display: inline-block;
        margin-top: 5px;
    }
    
    .option-duration {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
        padding: 0 5px;
        position: relative;
        min-width: 90px;
    }
    
    .duration-line {
        width: 100%;
        height: 2px;
        background: #ddd;
        margin: 8px 0;
        position: relative;
    }
    
    .duration-line::before {
        content: '';
        position: absolute;
        width: 8px;
        height: 8px;
        background: #1a237e;
        border-radius: 50%;
        top: -3px;
        left: 0;
    }
    
    .duration-line::after {
        content: '';
        position: absolute;
        width: 8px;
        height: 8px;
        background: #1a237e;
        border-radius: 50%;
        top: -3px;
        right: 0;
    }
    
    .duration-time {
        font-size: 1rem;
        font-weight: bold;
        color: #1a237e;
        margin-bottom: 3px;
    }
    
    .duration-distance {
        font-size: 0.75rem;
        color: #636e72;
        margin-top: 3px;
    }
    
    .stopover-details {
        font-size: 0.7rem;
        color: #ff9f43;
        margin-top: 5px;
        text-align: center;
        background: #fff5e6;
        padding: 2px 6px;
        border-radius: 10px;
        white-space: nowrap;
    }
    
    /* FOOTER - Gharama na kitufe */
    .option-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 15px;
        background: #f8f9fa;
        border-top: 1px solid #eee;
    }
    
    .price-section {
        display: flex;
        flex-direction: column;
    }
    
    .option-price {
        font-size: 1.4rem;
        font-weight: bold;
        color: #10ac84;
    }
    
    .price-details {
        font-size: 0.8rem;
        color: #636e72;
        margin-top: 3px;
    }
    
    .select-btn {
        background: linear-gradient(135deg, #1a237e, #283593);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 600;
        font-size: 0.9rem;
        white-space: nowrap;
    }
    
    .select-btn:hover {
        background: linear-gradient(135deg, #283593, #3949ab);
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(26, 35, 126, 0.2);
    }
}

/* Uboreshaji wa ziada kwa skrini ndogo sana */
@media (max-width: 480px) {
    .option-body {
        grid-template-columns: 1fr auto 1fr;
        padding: 12px;
        gap: 8px;
    }
    
    .option-time {
        font-size: 1.3rem;
    }
    
    .option-city {
        font-size: 0.9rem;
    }
    
    .duration-time {
        font-size: 0.95rem;
    }
    
    .duration-distance {
        font-size: 0.7rem;
    }
    
    .option-price {
        font-size: 1.3rem;
    }
    
    .select-btn {
        padding: 8px 15px;
        font-size: 0.85rem;
    }
    
    .company-name {
        font-size: 0.85rem;
    }
    
    .option-number {
        font-size: 0.8rem;
        padding: 3px 8px;
    }
}
        
        .transport-btn::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, #ffd700, transparent);
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }
        
        .transport-btn.active {
            background-color: #1a237e;
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(26, 35, 126, 0.3);
        }
        
        .transport-btn.active::before {
            width: 80%;
            box-shadow: 0 0 15px #ffd700;
        }
        
        .transport-btn:hover:not(.active) {
            background-color: #f0f0f0;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        .booking-form {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
            transition: opacity 0.3s ease;
        }
        
        /* MAREKEBISHO YA 1: Button ya Back kwenye Safari Details */
        .back-button-container {
            margin-bottom: 20px;
            text-align: left;
        }
        
        .back-btn {
            background: linear-gradient(135deg, #636e72, #2d3436);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .back-btn:hover {
            background: linear-gradient(135deg, #2d3436, #1a237e);
            transform: translateX(-3px);
        }
        
        .safari-details-title {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .safari-details-title h2 {
            flex: 1;
            margin: 0;
        }
        
        .form-title {
            font-size: 1.4rem;
            margin-bottom: 25px;
            color: #1a237e;
            text-align: center;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .form-group {
            margin-bottom: 15px;
            position: relative;
            color: #1a237e;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2d3436;
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
            transition: border 0.3s ease;
            background-color: white;
        }
        
        input:focus, select:focus {
            border-color: #1a237e;
            outline: none;
            box-shadow: 0 0 0 2px rgba(26, 35, 126, 0.2);
        }
        
        .searchable-dropdown {
            position: relative;
            width: 100%;
        }
        
        .dropdown-input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
            background-color: white;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .dropdown-input:after {
            content: '\f078';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            color: #636e72;
            transition: transform 0.3s ease;
        }
        
        .dropdown-input.open:after {
            transform: rotate(180deg);
        }
        
        .dropdown-options {
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            max-height: 200px;
            overflow-y: auto;
            background: white;
            border: 1px solid #ddd;
            border-top: none;
            border-radius: 0 0 6px 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            z-index: 100;
            display: none;
        }
        
        .dropdown-options.open {
            display: block;
        }
        
        .search-input {
            width: 100%;
            padding: 10px 15px;
            border: none;
            border-bottom: 1px solid #eee;
            font-size: 1rem;
            outline: none;
        }
        
        .dropdown-option {
            padding: 10px 15px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .dropdown-option:hover {
            background-color: #f5f7fa;
        }
        
        .dropdown-option.selected {
            background-color: #e3f2fd;
            color: #1a237e;
            font-weight: 600;
        }
        
        .city-code {
            font-size: 0.8rem;
            color: #636e72;
            margin-left: 5px;
        }
        
        .no-results {
            padding: 10px;
            text-align: center;
            color: #636e72;
            font-style: italic;
        }
        
        .search-btn {
            background: linear-gradient(135deg, #1a237e, #6c5ce7);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1rem;
            border-radius: 8px;
            cursor: pointer;
            display: block;
            margin: 0 auto;
            transition: all 0.3s ease;
            font-weight: 600;
            width: 100%;
            position: relative;
            overflow: hidden;
        }
        
        .search-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(26, 115, 232, 0.3);
        }
        
        .search-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .search-spinner {
            display: none;
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #1a237e;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Recommended Trips Section */
        .recommended-trips {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            margin: 30px 0;
        }

        .recommended-title {
            font-size: 1.6rem;
            margin-bottom: 25px;
            color: #1a237e;
            text-align: center;
        }

        .recommended-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .recommended-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            border-left: 5px solid #1a237e;
        }

        .recommended-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }

        .recommended-header {
            background: linear-gradient(90deg, #1a237e, #283593);
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .recommended-price {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ffd700;
        }

        .recommended-body {
            padding: 20px;
        }

        .recommended-route {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #2d3436;
        }

        .recommended-details {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            color: #636e72;
        }

        .recommended-description {
            font-size: 0.9rem;
            margin-bottom: 15px;
            color: #636e72;
        }

        .book-now-btn {
            background: linear-gradient(135deg, #1a73e8, #6c5ce7);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            width: 100%;
            transition: all 0.3s ease;
        }

        .book-now-btn:hover {
            background: linear-gradient(135deg, #1557b0, #5b4fcf);
            transform: translateY(-2px);
        }
        
        .results-section {
            display: none;
            margin-top: 30px;
        }
        
        .results-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #1a237e;
            text-align: center;
        }
        
        /* MAREKEBISHO YA 2: Matokeo ya safari kwa simu - kimstatili */
        .transport-options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .transport-option-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            border: 1px solid #e0e0e0;
        }
        
        .transport-option-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
        }
        
        .option-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #eee;
            flex-wrap: wrap;
        }
        
        .company-info {
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
            flex-wrap: wrap;
        }
        
        .company-logo {
            width: 100px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
           /* border-radius: 5px;
            background: white;
            border: 1px solid #e0e0e0;*/
        }
        
        .company-logo-img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            padding: 5px;
        }
        
        .company-logo-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 12px;
            text-align: center;
            color: #333;
            width: 100%;
            padding: 0 5px;
            font-weight: bold;
        }
        
        .company-name {
            font-weight: 600;
            color: #2d3436;
            font-size: 0.95rem;
        }
        
        .option-number {
            font-weight: bold;
            color: #1a237e;
            font-size: 0.9rem;
            background: #e3f2fd;
            padding: 4px 10px;
            border-radius: 15px;
        }
        
        /* MAREKEBISHO YA 2: Option body kwa simu - kimstatili */
        .option-body {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            padding: 20px;
            gap: 15px;
            align-items: center;
        }
        
        .option-departure, .option-arrival {
            text-align: center;
            padding: 10px;
        }
        
        .option-time {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 5px 0;
            color: #1a237e;
        }
        
        .option-city {
            font-size: 1.1rem;
            color: #636e72;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .option-date {
            font-size: 0.85rem;
            color: #636e72;
            background: #f8f9fa;
            padding: 3px 8px;
            border-radius: 10px;
            display: inline-block;
        }
        
        .option-duration {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 0 10px;
            position: relative;
            min-width: 100px;
        }
        
        .duration-line {
            width: 100%;
            height: 2px;
            background: #ddd;
            margin: 10px 0;
            position: relative;
        }
        
        .duration-line::before {
            content: '';
            position: absolute;
            width: 10px;
            height: 10px;
            background: #1a237e;
            border-radius: 50%;
            top: -4px;
            left: 0;
        }
        
        .duration-line::after {
            content: '';
            position: absolute;
            width: 10px;
            height: 10px;
            background: #1a237e;
            border-radius: 50%;
            top: -4px;
            right: 0;
        }
        
        .duration-time {
            font-size: 1.1rem;
            font-weight: bold;
            color: #1a237e;
            margin-bottom: 5px;
        }
        
        .duration-distance {
            font-size: 0.8rem;
            color: #636e72;
        }
        
        .stopover-details {
            font-size: 0.8rem;
            color: #ff9f43;
            margin-top: 5px;
            text-align: center;
        }
        
        .option-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: #f8f9fa;
            border-top: 1px solid #eee;
            flex-wrap: wrap;
        }
        
        .option-price {
            font-size: 1.5rem;
            font-weight: bold;
            color: #10ac84;
        }
        
        .price-details {
            font-size: 0.85rem;
            color: #636e72;
            margin-top: 5px;
        }
        
        .select-btn {
            background: linear-gradient(135deg, #1a237e, #283593);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s ease;
            font-size: 0.9rem;
        }
        
        .select-btn:hover {
            background: linear-gradient(135deg, #283593, #3949ab);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(26, 35, 126, 0.2);
        }
        
        .price-comparison {
            background-color: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
            display: none;
        }
        
        .price-comparison-title {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #1a237e;
            text-align: center;
            font-weight: bold;
        }
        
        .price-comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .price-comparison-item {
            padding: 15px;
            border-radius: 8px;
            background: #f8f9fa;
            text-align: center;
            border: 1px solid #e0e0e0;
            transition: transform 0.3s ease;
        }
        
        .price-comparison-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .price-comparison-item h3 {
            margin-bottom: 10px;
            color: #2d3436;
            font-size: 1.1rem;
        }
        
        .price-comparison-value {
            font-size: 1.3rem;
            font-weight: bold;
            color: #10ac84;
        }
        
        /* Media Queries kwa simu - Marekebisho ya 2 */
        @media (max-width: 768px) {
            .transport-options-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .transport-option-card {
                margin: 0 auto;
                max-width: 100%;
            }
            
            .option-body {
                grid-template-columns: 1fr;
                gap: 20px;
                padding: 15px;
            }
            
            .option-departure, .option-arrival {
                padding: 10px 0;
                text-align: center;
                border-bottom: 1px dashed #eee;
                position: relative;
            }
            
            .option-departure::after {
                content: "â†’";
                position: absolute;
                right: 10px;
                top: 50%;
                transform: translateY(-50%);
                font-size: 1.2rem;
                color: #1a237e;
            }
            
            .option-duration {
                order: 3;
                grid-column: 1;
                margin-top: 10px;
                padding: 15px;
                background: #f8f9fa;
                border-radius: 10px;
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
            
            .duration-line {
                width: 30%;
                height: 2px;
                margin: 0 10px;
            }
            
            .duration-time {
                order: 1;
                font-size: 1.1rem;
                margin-bottom: 0;
            }
            
            .duration-distance {
                order: 3;
                font-size: 0.85rem;
            }
            
            .option-time {
                font-size: 1.4rem;
            }
            
            .option-city {
                font-size: 1rem;
            }
            
            .option-footer {
                flex-direction: column;
                gap: 15px;
                align-items: stretch;
            }
            
            .select-btn {
                width: 100%;
                padding: 12px;
                font-size: 1rem;
            }
            
            .option-price {
                text-align: center;
                font-size: 1.6rem;
            }
            
            .price-details {
                text-align: center;
            }
            
            .recommended-grid {
                grid-template-columns: 1fr;
            }
            
            .recommended-trips {
                padding: 20px;
            }
            
            .recommended-title {
                font-size: 1.4rem;
            }
            
            .price-comparison-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .transport-options-grid {
                gap: 12px;
            }
            
            .option-header {
                padding: 12px 15px;
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }
            
            .company-info {
                width: 100%;
                justify-content: space-between;
            }
            
            .company-logo {
                width: 90px;
                height: 50px;
            }
            
            .option-number {
                font-size: 0.85rem;
            }
            
            .option-body {
                padding: 12px;
                gap: 15px;
            }
            
            .option-time {
                font-size: 1.3rem;
            }
            
            .option-footer {
                padding: 12px 15px;
            }
            
            .option-price {
                font-size: 1.4rem;
            }
        }
        
        .seat-selection {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            display: none;
            margin-top: 30px;
        }
        
        .seat-selection-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #2d3436;
            text-align: center;
        }
        
        .transport-layout {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .transport-steering {
            font-size: 2rem;
            color: #636e72;
        }
        
        .flight-seats, .train-seats, .bus-seats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }
        
        .seat {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .seat.available {
            background-color: #10ac84;
            color: white;
        }
        
        .seat.available:hover {
            background-color: #0d966f;
            transform: scale(1.05);
        }
        
        .seat.selected {
            background-color: #1a73e8;
            color: white;
            transform: scale(1.05);
        }
        
        .seat.occupied {
            background-color: #ddd;
            color: #636e72;
            cursor: not-allowed;
        }
        
        .seat.emergence {
            background-color: #ff9f43;
            color: white;
        }
        
        .seat.business {
            background-color: #6c5ce7;
            color: white;
        }
        
        .seat.first-class {
            background-color: #e84393;
            color: white;
        }
        
        .seat-info {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .seat-info-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.85rem;
        }
        
        .seat-color {
            width: 18px;
            height: 18px;
            border-radius: 4px;
        }
        
        .color-available {
            background-color: #10ac84;
        }
        
        .color-selected {
            background-color: #1a73e8;
        }
        
        .color-occupied {
            background-color: #ddd;
        }
        
        .color-emergency {
            background-color: #ff9f43;
        }
        
        .color-business {
            background-color: #6c5ce7;
        }
        
        .color-first-class {
            background-color: #e84393;
        }
        
        .confirm-seat-btn {
            background: linear-gradient(135deg, #1a73e8, #6c5ce7);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1rem;
            border-radius: 8px;
            cursor: pointer;
            display: block;
            margin: 20px auto 0;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .confirm-seat-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(26, 115, 232, 0.3);
        }
        
        .confirm-seat-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        /* Safari Details Section - MAREKEBISHO YA 1 */
        .safari-details {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            display: none;
            margin-top: 30px;
        }

        .safari-details-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #1a237e;
            text-align: center;
        }

        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .detail-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #1a237e;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .detail-card h4 {
            color: #1a237e;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1rem;
        }

        .detail-card p {
            color: #2d3436;
            line-height: 1.5;
            font-size: 0.9rem;
        }

        .terms-agreement {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 1px solid #bbdefb;
        }

        .terms-checkbox {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 15px;
        }

        .terms-checkbox input {
            width: 20px;
            height: 20px;
            margin-top: 3px;
        }

        .terms-text {
            font-size: 0.9rem;
            color: #2d3436;
            line-height: 1.5;
        }

        .continue-btn {
            background: linear-gradient(135deg, #10ac84, #0d966f);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1rem;
            border-radius: 8px;
            cursor: pointer;
            display: block;
            margin: 20px auto 0;
            transition: all 0.3s ease;
            font-weight: 600;
            width: 200px;
        }

        .continue-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(16, 172, 132, 0.3);
        }

        .continue-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
            font-size: 0.9rem;
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .info-label {
            color: #636e72;
            font-weight: 500;
        }

        .info-value {
            color: #2d3436;
            font-weight: 600;
            text-align: right;
            max-width: 60%;
        }
        
        .passenger-form {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            display: none;
            margin-top: 30px;
        }
        
        .passenger-form-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #2d3436;
            text-align: center;
        }
        
        .passenger-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .passenger-form-group {
            margin-bottom: 15px;
            padding: 15px;
            border: 1px solid #eee;
            border-radius: 8px;
            background: #f8f9fa;
        }
        
        .passenger-form-group h3 {
            margin-bottom: 15px;
            color: #1a73e8;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            font-size: 1rem;
        }
        
        .shared-details {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px dashed #ddd;
        }
        
        .optional-field {
            color: #636e72;
            font-size: 0.85rem;
            margin-top: 5px;
        }
        
        .book-ticket-btn {
            background: linear-gradient(135deg, #10ac84, #0d966f);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1rem;
            border-radius: 8px;
            cursor: pointer;
            display: block;
            margin: 20px auto 0;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .book-ticket-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(16, 172, 132, 0.3);
        }
        
        .ticket-display {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            display: none;
            margin-top: 30px;
        }
        
        .ticket-print-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .ticket-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            text-align: left;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px dashed #ddd;
            position: relative;
        }
        
        .ticket-company-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            flex: 1;
        }
        
        .ticket-company-banner {
            display: flex;
            justify-content: flex-start;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px;
            width: 100%;
            max-width: 300px;
        }
        
        .ticket-ref-section {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            flex: 1;
            text-align: right;
        }
        
        .ticket-ref-with-barcode {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            margin: 0;
            padding: 15px;
            max-width: 300px;
        }
        
        .ref-number {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.1rem;
            color: #2d3436;
            text-align: center;
            width: 100%;
        }
        
        .barcode {
            height: 60px;
            margin: 10px 0;
            background: white;
            padding: 8px;
            border-radius: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
        }
        
        .barcode-lines {
            display: flex;
            height: 100%;
            align-items: center;
        }
        
        .barcode-line {
            background-color: #000;
            margin: 0 1px;
            height: 100%;
        }
        
        .barcode-line.wide {
            width: 3px;
        }
        
        .barcode-line.narrow {
            width: 1px;
        }
        
        .barcode-instruction {
            font-size: 0.8rem;
            color: #636e72;
            margin-top: 5px;
            text-align: center;
            width: 100%;
        }
        
        .ticket-title {
            text-align: center;
            width: 100%;
            margin-bottom: 20px;
            color: #1a73e8;
            font-size: 1.8rem;
        }
        
        .ticket-body {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .ticket-column {
            flex: 1;
            min-width: 250px;
        }
        
        .ticket-info {
            margin-bottom: 15px;
            display: flex;
        }
        
        .ticket-info strong {
            display: inline-block;
            min-width: 120px;
            color: #2d3436;
            font-size: 0.9rem;
        }
        
        .ticket-info span {
            flex: 1;
            font-size: 0.9rem;
        }
        
        .ticket-passenger-list {
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .passenger-item {
            padding: 8px 0;
            border-bottom: 1px solid #ddd;
            font-size: 0.9rem;
        }
        
        .passenger-item:last-child {
            border-bottom: none;
        }
        
        .ticket-payment-info {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px dashed #ddd;
        }
        
        .ticket-company-logo {
            width: 120px;
            height: 60px;
            overflow: hidden;
            margin: 10px auto;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .ticket-company-logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .ticket-company-logo div {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
        }
        
        .ticket-footer {
            margin-top: 25px;
            text-align: center;
            padding-top: 15px;
            border-top: 2px dashed #ddd;
            color: #636e72;
            font-size: 0.9rem;
        }
        
        .print-date {
            font-size: 0.8rem;
            color: #636e72;
            margin-top: 15px;
            text-align: center;
            font-style: italic;
        }
        
        .selected-option {
            background-color: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
            display: none;
        }
        
        .selected-header {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #1a237e;
            text-align: center;
            font-weight: bold;
        }
        
        .print-ticket-btn {
            background: linear-gradient(135deg, #1a73e8, #6c5ce7);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1rem;
            border-radius: 8px;
            cursor: pointer;
            display: block;
            margin: 20px auto;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .print-ticket-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(26, 115, 232, 0.3);
        }
        
        .bus-layout-container {
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .bus-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #ddd;
        }
        
        .bus-steering {
            width: 100%;
            height: 60px;
            background: #636e72;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .bus-seats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .bus-seat {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            position: relative;
            margin: 0 auto;
        }
        
        .bus-aisle {
            grid-column: span 4;
            height: 30px;
            background-color: #ddd;
            margin: 10px 0;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #636e72;
            font-size: 12px;
        }
        
        .selected-seat-info {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: #e3f2fd;
            border-radius: 8px;
            font-weight: bold;
            display: none;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            z-index: 1000;
            opacity: 0;
            transform: translateY(-20px);
            transition: opacity 0.3s, transform 0.3s;
            max-width: 350px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .notification.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .notification.success {
            background-color: #10ac84;
            border-left: 5px solid #0d966f;
        }
        
        .notification.error {
            background-color: #ee5f5f;
            border-left: 5px solid #d63031;
        }
        
        .notification.warning {
            background-color: #ff9f43;
            border-left: 5px solid #f39c12;
        }
        
        .notification.info {
            background-color: #1a73e8;
            border-left: 5px solid #1557b0;
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        
        .loading-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #1a73e8;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        .error-message {
            color: #ee5f5f;
            font-size: 0.85rem;
            margin-top: 5px;
            display: none;
        }
        
        .form-group.error input,
        .form-group.error select,
        .form-group.error .dropdown-input {
            border-color: #ee5f5f;
            background-color: #fff5f5;
        }
        
        .form-group.error .error-message {
            display: block;
        }

        /* Footer Styles */
        .site-footer {
            background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
            color: white;
            padding: 40px 0 20px;
            margin-top: 20px;
            border-radius: 12px 12px 0 0;
        }

        .footer-container {
            max-width: 100%;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            padding: 0 20px;
        }

        .footer-section {
            padding: 10px;
        }

        .footer-section h3 {
            color: #ffd700;
            margin-bottom: 20px;
            font-size: 1.2rem;
            border-bottom: 2px solid #ffd700;
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .footer-section p {
            line-height: 1.6;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }

        .footer-section i {
            color: #ffd700;
            width: 20px;
        }

        .social-icons {
            display: flex;
            gap: 15px;
            margin: 20px 0;
        }

        .social-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            color: white;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .social-icon:hover {
            background: #ffd700;
            color: #1a237e;
            transform: translateY(-3px);
        }

        .footer-bottom {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
        }

        .footer-bottom a {
            color: #ffd700;
            text-decoration: none;
        }

        .footer-bottom a:hover {
            text-decoration: underline;
        }
        
        @media print {
            body * {
                visibility: hidden;
            }
            
            .ticket-display, 
            .ticket-display * {
                visibility: visible;
            }
            
            .ticket-display {
                position: absolute !important;
                left: 0 !important;
                top: 0 !important;
                width: 100% !important;
                margin: 0 !important;
                padding: 20px !important;
                box-shadow: none !important;
                background: white !important;
                border: none !important;
            }
            
            .print-ticket-btn,
            .transport-options,
            .booking-form,
            .price-comparison,
            .results-section,
            .selected-option,
            .seat-selection,
            .safari-details,
            .passenger-form,
            header,
            footer,
            .notification,
            .loading-overlay {
                display: none !important;
            }
            
            .ticket-header {
                display: flex !important;
                justify-content: space-between !important;
                align-items: flex-start !important;
            }
            
            .ticket-company-section {
                display: flex !important;
                flex-direction: column !important;
                align-items: flex-start !important;
            }
            
            .ticket-ref-section {
                display: flex !important;
                flex-direction: column !important;
                align-items: flex-end !important;
            }
            
            .ticket-company-banner {
                display: flex !important;
                justify-content: flex-start !important;
                max-width: 250px !important;
            }
            
            .ticket-ref-with-barcode {
                display: flex !important;
                flex-direction: column !important;
                align-items: flex-end !important;
                max-width: 250px !important;
            }
            
            .barcode {
                height: 50px !important;
                background: white !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
            .barcode-line {
                background-color: #000 !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
            .option-price,
            .price-comparison-value {
                color: #10ac84 !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
            @page {
                margin: 0.5cm;
            }
            
            .ticket-display {
                page-break-after: always;
                page-break-inside: avoid;
            }
            
            .ticket-display {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
                font-size: 12pt !important;
                line-height: 1.4 !important;
            }
            
            .ticket-header {
                border-bottom: 2px dashed #ddd !important;
            }
            
            .ticket-footer {
                border-top: 2px dashed #ddd !important;
            }
            
            .ticket-passenger-list,
            .ticket-ref-with-barcode,
            .ticket-company-banner {
                background: transparent !important;
            }
        }
        
        body.printing {
            background: white !important;
        }
        
        body.printing .container {
            max-width: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 90px 12px 20px;
            }
            
            header {
                padding: 15px 12px;
            }
            
            .header-left {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }
            
            .system-subtitle {
                font-size: 0.75rem;
            }
            
            .transport-options {
                gap: 8px;
            }
            
            .transport-btn {
                flex: 1 1 calc(33.333% - 10px);
            }
            
            .language-switcher {
                margin-left: auto;
            }
            
            .booking-form {
                padding: 20px;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .transport-options-grid {
                grid-template-columns: 1fr;
            }
            
            .option-body {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .option-departure::after {
                display: none;
            }
            
            .option-duration {
                order: 3;
                grid-column: 1;
                flex-direction: column;
                gap: 10px;
            }
            
            .duration-line {
                width: 100%;
                margin: 5px 0;
            }
            
            .duration-time {
                order: 1;
            }
            
            .duration-distance {
                order: 2;
            }
            
            .option-footer {
                flex-direction: column;
                gap: 15px;
                align-items: center;
                text-align: center;
            }
            
            .select-btn {
                width: 100%;
            }
            
            .ticket-header {
                flex-direction: column;
                align-items: center;
            }
            
            .ticket-company-section,
            .ticket-ref-section {
                align-items: center;
                text-align: center;
                width: 100%;
            }
            
            .ticket-ref-section {
                margin-top: 20px;
            }
            
            .ticket-company-banner,
            .ticket-ref-with-barcode {
                max-width: 100%;
            }
            
            .recommended-grid {
                grid-template-columns: 1fr;
            }
            
            .recommended-trips {
                padding: 20px;
            }
            
            .recommended-title {
                font-size: 1.4rem;
            }
            
            .site-footer {
                padding: 30px 15px 15px;
                margin-top: 30px;
            }
            
            .footer-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .footer-section {
                padding: 10px 5px;
                text-align: center;
            }
            
            .footer-section h3 {
                justify-content: center;
                font-size: 1.1rem;
            }
            
            .social-icons {
                justify-content: center;
            }
            
            .details-grid {
                grid-template-columns: 1fr;
            }
            
            .safari-details {
                padding: 20px;
            }
            
            .back-button-container {
                text-align: center;
                margin-bottom: 15px;
            }
            
            .safari-details-title {
                flex-direction: column;
                align-items: center;
                gap: 10px;
            }
            
            .safari-details-title h2 {
                text-align: center;
                font-size: 1.3rem;
            }
            
            .passenger-form {
                padding: 20px;
            }
            
            .passenger-details {
                grid-template-columns: 1fr;
            }
            
            .ticket-display {
                padding: 20px;
            }
        }
        
        @media (min-width: 769px) and (max-width: 1024px) {
            /* Tablet styles - Marekebisho ya 2 */
            .transport-options-grid {
                grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
                gap: 20px;
            }
            
            .option-body {
                grid-template-columns: 1fr auto 1fr;
                padding: 20px;
            }
            
            .option-duration {
                min-width: 120px;
            }
            
            .option-time {
                font-size: 1.5rem;
            }
            
            .option-city {
                font-size: 1.1rem;
            }
            
            .footer-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <div class="header-left">
            <div style="display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-plane-departure logo-icon"></i>
                <div>
                    <h1><span>Gideon</span><span>Booking</span></h1>
                    <p class="system-subtitle" data-i18n="systemSubtitle">Mfumo wa Kukata Tiketi</p>
                </div>
            </div>
        </div>
        
        <!-- Marekebisho ya 1: Kitufe cha lugha kwa simu -->
        <div class="language-switcher">
            <button class="language-toggle" id="language-toggle" title="Badilisha Lugha">
                <i class="fas fa-globe"></i>
            </button>
            
            <!-- Dropdown ya lugha kwa simu -->
            <div class="mobile-language-dropdown" id="mobile-language-dropdown">
                <button class="mobile-lang-btn active" data-lang="sw">
                    <span>ðŸ‡¹ðŸ‡¿</span>
                    <span>Kiswahili</span>
                </button>
                <button class="mobile-lang-btn" data-lang="en">
                    <span>ðŸ‡¬ðŸ‡§</span>
                    <span>English</span>
                </button>
            </div>
            
            <!-- Lugha kwa desktop -->
            <button class="lang-btn active" data-lang="sw">ðŸ‡¹ðŸ‡¿ Kiswahili</button>
            <button class="lang-btn" data-lang="en">ðŸ‡¬ðŸ‡§ English</button>
        </div>
    </header>

    <div class="transport-options">
        <button class="transport-btn flight-btn active" data-type="flight">
            <i class="fas fa-plane"></i> <span class="transport-text">Ndege</span>
        </button>
        <button class="transport-btn train-btn" data-type="train">
            <i class="fas fa-train"></i> <span class="transport-text">Treni</span>
        </button>
        <button class="transport-btn bus-btn" data-type="bus">
            <i class="fas fa-bus"></i> <span class="transport-text">Basi</span>
        </button>
    </div>

    <div class="booking-form" id="booking-form">
        <h2 class="form-title" id="form-title">Tafuta Safari za Ndege</h2>
        
        <div class="form-grid">
            <div class="form-group">
                <label for="from" style="color: #1a237e;"><i class="fas fa-plane-departure"></i>  <span data-i18n="from">Kutoka:</span></label>
                <div class="searchable-dropdown" id="from-dropdown">
                    <div class="dropdown-input">
                        <span class="selected-text" data-i18n="selectCity">Chagua mji</span>
                    </div>
                    <div class="dropdown-options">
                        <input type="text" class="search-input" placeholder="Tafuta mji..." data-i18n-placeholder="searchCity">
                        <div class="dropdown-options-list"></div>
                    </div>
                </div>
                <div class="error-message" data-i18n="fieldRequired">Sehemu hii inahitajika</div>
            </div>
            
            <div class="form-group">
                <label for="to" style="color: #1a237e;"><i class="fas fa-plane-arrival"></i>  <span data-i18n="to">Kwenda:</span></label>
                <div class="searchable-dropdown" id="to-dropdown">
                    <div class="dropdown-input">
                        <span class="selected-text" data-i18n="selectCity">Chagua mji</span>
                    </div>
                    <div class="dropdown-options">
                        <input type="text" class="search-input" placeholder="Tafuta mji..." data-i18n-placeholder="searchCity">
                        <div class="dropdown-options-list"></div>
                    </div>
                </div>
                <div class="error-message" data-i18n="fieldRequired">Sehemu hii inahitajika</div>
            </div>
            
            <div class="form-group">
                <label for="departure" style="color: #1a237e;"><i class="fas fa-calendar-alt"></i>  <span data-i18n="departureDate">Tarehe ya Kuondoka:</span></label>
                <input type="date" id="departure" style="color: #1a237e;">
                <div class="error-message" data-i18n="fieldRequired">Sehemu hii inahitajika</div>
            </div>
            
            <div class="form-group">
                <label for="passengers" style="color: #1a237e"><i class="fas fa-users"></i>  <span data-i18n="passengers">Idadi ya Abiria:</span></label>
                <select id="passengers" style="color: #1a237e;">
                    <option value="1" data-i18n="passenger1">Abiria 1</option>
                    <option value="2" data-i18n="passenger2">Abiria 2</option>
                    <option value="3" data-i18n="passenger3">Abiria 3</option>
                    <option value="4" data-i18n="passenger4">Abiria 4</option>
                    <option value="5" data-i18n="passenger5">Abiria 5</option>
                </select>
            </div>
        </div>
        
        <div class="search-spinner" id="search-spinner"></div>
        
        <button class="search-btn" id="search-btn">
            <i class="fas fa-search"></i> <span data-i18n="search">Tafuta Safari</span>
        </button>
    </div>
    
    <!-- SEHEMU MPYA: Safari Zilizopendekezwa -->
    <div class="recommended-trips" id="recommended-trips">
        <h2 class="recommended-title">
            <i class="fas fa-fire"></i> <span data-i18n="recommendedTrips">Safari Zilizopendekezwa</span>
        </h2>
        
        <div class="recommended-grid" id="recommended-grid">
            <!-- Hot deals will be loaded here by JavaScript -->
        </div>
    </div>
    
    <div class="price-comparison" id="price-comparison" style="display: none;">
        <h2 class="price-comparison-title" data-i18n="priceComparison">Ulinganisho wa Bei za Usafiri</h2>
        <div class="price-comparison-grid">
            <div class="price-comparison-item">
                <h3 data-i18n="flight">Ndege</h3>
                <div class="price-comparison-value" id="flight-price">TZS 0</div>
                <p data-i18n="perKm">Kwa kilomita: TZS <span id="flight-per-km">350</span></p>
            </div>
            <div class="price-comparison-item">
                <h3 data-i18n="train">Treni</h3>
                <div class="price-comparison-value" id="train-price">TZS 0</div>
                <p data-i18n="perKm">Kwa kilomita: TZS <span id="train-per-km">120</span></p>
            </div>
            <div class="price-comparison-item">
                <h3 data-i18n="bus">Basi</h3>
                <div class="price-comparison-value" id="bus-price">TZS 0</div>
                <p data-i18n="perKm">Kwa kilomita: TZS <span id="bus-per-km">80</span></p>
            </div>
        </div>
    </div>
    
    <div class="results-section" id="results-section" style="display: none;">
        <h2 class="results-title"><i class="fas fa-search"></i> <span data-i18n="searchResults">Matokeo ya Utafutaji</span></h2>
        <div class="transport-options-grid" id="transport-options">
            <!-- Results will appear here -->
        </div>
    </div>
    
    <div class="selected-option" id="selected-option" style="display: none;">
        <h2 class="selected-header" data-i18n="selectedTrip">Safari Uliyoichagua</h2>
        <div id="selected-option-details"></div>
    </div>
    
    <div class="seat-selection" id="seat-selection" style="display: none;">
        <h2 class="seat-selection-title" data-i18n="chooseSeat">Chagua Kiti Chako</h2>
        
        <div class="seat-info">
            <div class="seat-info-item">
                <div class="seat-color color-available"></div>
                <span data-i18n="available">Inapatikana</span>
            </div>
            <div class="seat-info-item">
                <div class="seat-color color-selected"></div>
                <span data-i18n="selected">Umechagua</span>
            </div>
            <div class="seat-info-item">
                <div class="seat-color color-occupied"></div>
                <span data-i18n="occupied">Imejaa</span>
            </div>
            <div class="seat-info-item">
                <div class="seat-color color-emergency"></div>
                <span data-i18n="emergency">Dharura</span>
            </div>
            <div class="seat-info-item">
                <div class="seat-color color-business"></div>
                <span data-i18n="business">Biashara</span>
            </div>
            <div class="seat-info-item">
                <div class="seat-color color-first-class"></div>
                <span data-i18n="firstClass">Daraja la Kwanza</span>
            </div>
        </div>
        
        <div class="transport-layout" id="transport-layout">
            <!-- Seats will appear here -->
        </div>
        
        <button class="confirm-seat-btn" id="confirm-seat-btn" disabled>
            <span data-i18n="confirmSeat">Thibitisha Kiti</span>
        </button>
    </div>
    
    <!-- SEHEMU MPYA: Maelezo ya Safari -->
    <div class="safari-details" id="safari-details" style="display: none;">
        <div class="back-button-container">
            <button class="back-btn" id="back-to-results-btn">
                <i class="fas fa-arrow-left"></i> <span data-i18n="backToResults">Rudi kwenye Matokeo</span>
            </button>
        </div>
        
        <div class="safari-details-title">
            <h2 data-i18n="safariDetails">Maelezo ya Safari</h2>
        </div>
        
        <div class="details-grid" id="safari-details-content">
            <!-- Details will be loaded here -->
        </div>
        
        <div class="terms-agreement">
            <div class="terms-checkbox">
                <input type="checkbox" id="agree-terms">
                <label for="agree-terms" class="terms-text" data-i18n="termsText">
                    Nimekubaliana na sheria na masharti ya usafiri. Nimeelewa kuhusu aina ya chombo, mizigo inayoruhusiwa, na huduma zilizojumuishwa kwenye nauli.
                </label>
            </div>
            <div class="terms-checkbox">
                <input type="checkbox" id="agree-luggage">
                <label for="agree-luggage" class="terms-text" data-i18n="luggageTerms">
                    Nimekubali mipaka ya mizigo (20kg kwa abiria mmoja). Mizigo ya ziada italipwa kando.
                </label>
            </div>
        </div>
        
        <button class="continue-btn" id="continue-btn" disabled>
            <span data-i18n="continueToPassenger">Endelea na Taarifa za Abiria</span>
        </button>
    </div>
    
    <div class="passenger-form" id="passenger-form" style="display: none;">
        <h2 class="passenger-form-title" data-i18n="passengerInfo">Taarifa za Abiria</h2>
        
        <div class="passenger-details" id="passenger-details">
            <!-- Passenger forms will appear here -->
        </div>
        
        <div class="shared-details">
            <h3 data-i18n="contactDetails">Maelezo ya Mawasiliano</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label for="contact-email" data-i18n="email">Barua Pepe:</label>
                    <input type="email" id="contact-email" placeholder="mwananchi@example.com" required>
                    <div class="error-message" data-i18n="fieldRequired">Sehemu hii inahitajika</div>
                </div>
                <div class="form-group">
                    <label for="contact-phone" data-i18n="phone">Nambari ya Simu:</label>
                    <input type="tel" id="contact-phone" placeholder="+255 123 456 789" required>
                    <div class="error-message" data-i18n="fieldRequired">Sehemu hii inahitajika</div>
                </div>
                <div class="form-group">
                    <label for="id-number" data-i18n="idNumber">Nambari ya Kitambulisho:</label>
                    <input type="text" id="id-number" placeholder="Nambari ya kitambulisho (siyo lazima)">
                    <div class="optional-field" data-i18n="optional">* Sehemu hii siyo ya lazima</div>
                </div>
            </div>
        </div>
        
        <button class="book-ticket-btn" id="book-ticket-btn">
            <i class="fas fa-ticket-alt"></i> <span data-i18n="payGetTicket">Lipa na Pata Tiketi</span>
        </button>
    </div>
    
    <div class="ticket-display" id="ticket-display" style="display: none;">
        <!-- Ticket will appear here -->
    </div>
    
    <!-- FOOTER -->
    <footer class="site-footer">
        <div class="footer-container">
            <div class="footer-section about-us">
                <h3><i class="fas fa-info-circle"></i> <span data-i18n="aboutUs">KUHUSU SISI</span></h3>
                <p data-i18n="aboutUsDesc">GideonBooking ni mfumo wa kisasa wa upatikanaji wa tiketi kwa usafiri wa ndege, treni na basi nchini Tanzania. Tunakusudia kurahisisha usafiri wako.</p>
            </div>
            
            <div class="footer-section contact">
                <h3><i class="fas fa-phone-alt"></i> <span data-i18n="contactUs">WASILIANA NASI</span></h3>
                <p><i class="fas fa-map-marker-alt"></i> <span data-i18n="location">Dar es Salaam, Tanzania</span></p>
                <p><i class="fas fa-phone"></i> <span data-i18n="phone">+255 123 456 789</span></p>
                <p><i class="fas fa-envelope"></i> <span data-i18n="email">info@gideonbooking.co.tz</span></p>
            </div>
            
            <div class="footer-section social-media">
                <h3><i class="fas fa-share-alt"></i> <span data-i18n="socialMedia">MITANDAO YA KIJAMII</span></h3>
                <div class="social-icons">
                    <a href="#" class="social-icon" title="Facebook"><i class="fab fa-facebook"></i></a>
                    <a href="#" class="social-icon" title="Twitter"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="social-icon" title="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="social-icon" title="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                </div>
                <p data-i18n="socialMediaDesc">Fuata nyuzi zetu za habari na upate ofa za kipekee.</p>
            </div>
            
            <div class="footer-section quick-links">
                <h3><i class="fas fa-link"></i> <span data-i18n="quickLinks">VIUNGO VYA HARAKA</span></h3>
                <p><a href="#" style="color: white; text-decoration: none;" data-i18n="home">Nyumbani</a></p>
                <p><a href="#" style="color: white; text-decoration: none;" data-i18n="flights">Ndege</a></p>
                <p><a href="#" style="color: white; text-decoration: none;" data-i18n="trains">Treni</a></p>
                <p><a href="#" style="color: white; text-decoration: none;" data-i18n="buses">Basi</a></p>
                <p><a href="#" style="color: white; text-decoration: none;" data-i18n="contact">Wasiliana</a></p>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>&copy; 2024 GideonBooking. <span data-i18n="allRightsReserved">Haki zote zimehifadhiwa.</span> | 
                <a href="#" data-i18n="privacyPolicy">Sera ya Faragha</a> | 
                <a href="#" data-i18n="termsConditions">Vigezo na Masharti</a>
            </p>
            <p style="margin-top: 10px; font-size: 0.8rem;" data-i18n="footerNote">
                Tunaendelea kuboresha huduma zetu ili kukuhudumia vyema. Asante kwa kuwa mteja wetu.
            </p>
        </div>
    </footer>
    
    <div id="notification-area"></div>
    
    <div class="loading-overlay" id="loading-overlay">
        <div class="spinner"></div>
        <div style="margin-top: 20px; color: #1a237e; font-weight: 600;" data-i18n="loading">Inapakia...</div>
    </div>
</div>

<script>
    // Data for language translation
    const translations = {
        sw: {
            // Transport types
            "flight": "Ndege",
            "train": "Treni", 
            "bus": "Basi",
            
            // Form labels
            "systemSubtitle": "Mfumo wa Kukata Tiketi",
            "searchFlights": "Tafuta Safari za Ndege",
            "searchTrains": "Tafuta Safari za Treni",
            "searchBuses": "Tafuta Safari za Basi",
            "from": "Kutoka:",
            "to": "Kwenda:",
            "departureDate": "Tarehe ya Kuondoka:",
            "passengers": "Idadi ya Abiria:",
            "passenger1": "Abiria 1",
            "passenger2": "Abiria 2",
            "passenger3": "Abiria 3",
            "passenger4": "Abiria 4",
            "passenger5": "Abiria 5",
            "search": "Tafuta Safari",
            "searching": "Inatafuta...",
            "selectCity": "Chagua mji",
            "searchCity": "Tafuta mji...",
            "fieldRequired": "Sehemu hii inahitajika",
            
            // Results
            "searchResults": "Matokeo ya Utafutaji",
            "noResults": "Hakuna matokeo",
            "noTransportFound": "Hakuna safari za __type__ zilizopatikana kwenye ruti hii",
            "tryDifferent": "Tafadhali jaribu ruti tofauti au usafiri mwingine.",
            "noTripsToday": "Hakuna safari za __type__ zilizopatikana kwa leo",
            "noTripsAfter": "Hakuna safari zinazoanza baada ya __time__ leo.",
            "tryDifferentDate": "Tafadhali chagua tarehe tofauti au jaribu usafiri mwingine.",
            
            // Selection
            "selectedTrip": "Safari Uliyoichagua",
            "chooseSeat": "Chagua Kiti Chako",
            "available": "Inapatikana",
            "selected": "Umechagua",
            "occupied": "Imejaa",
            "emergency": "Dharura",
            "business": "Biashara",
            "firstClass": "Daraja la Kwanza",
            "confirmSeat": "Thibitisha Kiti",
            "select": "Chagua",
            "passenger": "Abiria",
            "passengersCount": "Kwa abiria __count__",
            "stopovers": "__count__ kituo",
            "directFlight": "Moja kwa Moja",
            "stopoverFlight": "Na Vituo",
            "stopover": "Stop",
            "nextDay": "+1 siku",
            
            // Passenger form
            "passengerInfo": "Taarifa za Abiria",
            "passenger": "Abiria",
            "fullName": "Jina Kamili:",
            "idNumber": "Nambari ya Kitambulisho (Hiari):",
            "age": "Umri:",
            "gender": "Jinsia:",
            "chooseGender": "Chagua Jinsia",
            "male": "Mwanaume",
            "female": "Mwanamke",
            "contactDetails": "Maelezo ya Mawasiliano",
            "email": "Barua Pepe:",
            "phone": "Nambari ya Simu:",
            "optional": "* Sehemu hii siyo ya lazima",
            "payGetTicket": "Lipa na Pata Tiketi",
            "seatInfo": "Taarifa za Kiti",
            "seatNumber": "Namba ya Kiti:",
            "firstNamePlaceholder": "Jina la kwanza la familia",
            "idPlaceholder": "Namba ya NIDA/Passport (siyo lazima)",
            "agePlaceholder": "Umri wa abiria",
            
            // Ticket
            "yourTravelTicket": "Tiketi Yako ya Usafiri",
            "from": "Kutoka:",
            "to": "Kwenda:",
            "departureDate": "Tarehe ya Kuondoka:",
            "departureTime": "Muda wa Kuondoka:",
            "transportType": "Aina ya Usafiri:",
            "company": "Kampuni:",
            "transportNumber": "__type__ Namba:",
            "tripType": "Aina ya Safari:",
            "seat": "Kiti:",
            "arrivalTime": "Muda wa Kufika:",
            "arrivalDate": "Tarehe ya Kufika:",
            "passengerList": "Orodha ya Abiria",
            "totalPayment": "Jumla ya Malipo:",
            "contact": "Mawasiliano:",
            "thanks": "Asante kwa kuchagua __company__. Safari njema!",
            "instructions": "Maelekezo: Wasili kituoni angalau dakika 45 kabla ya safari.",
            "nextDayNotice": "Angalizo: Safari hii inavuka usiku na kufika siku inayofuata.",
            "printed": "Ilichapishwa:",
            "printTicket": "Print Tiketi",
            "scanBarcode": "Scan barcode hapa kuthibitisha tiketi yako",
            "referenceNumber": "Namba ya kumbukumbu:",
            "years": "miaka",
            "checkIn": "check In",
            
            // Notifications
            "fillRequired": "Tafadhali jaza sehemu zote zinazohitajika.",
            "differentCities": "Lazima uchague miji tofauti kwa kutoka na kwenda.",
            "chooseTripFirst": "Tafadhali chagua safari kwanza.",
            "ticketSaved": "Tiketi imehifadhiwa kikamilifu!",
            "filledFromDeal": "Taarifa zimejazwa kiotomatiki kutoka kwa ofa!",
            
            // Price comparison
            "priceComparison": "Ulinganisho wa Bei za Usafiri",
            "perKm": "Kwa kilomita:",
            
            // Bus layout
            "driverSection": "Sehemu ya Dereva",
            "clickToSelectSeat": "Bofya kwenye kiti utakachochagua",
            "aisle": "Njia ya Kati",
            "selectedSeat": "Umechagua Kiti:",
            
            // Recommended trips
            "recommendedTrips": "Safari Zilizopendekezwa",
            "takeThisDeal": "Chukua Ofa Hii",
            "departsEvery": "Kuondoka kila",
            "departsAt": "Kuondoka saa",
            
            // Safari details
            "safariDetails": "Maelezo ya Safari",
            "travelInfo": "Taarifa za Safari",
            "vehicleDetails": "Maelezo ya Chombo",
            "luggageServices": "Mizigo na Huduma",
            "paymentDetails": "Maelezo ya Malipo",
            "vehicleType": "Aina ya Chombo:",
            "tripNumber": "Nambari ya Safari:",
            "allowedLuggage": "Mizigo Inayoruhusiwa:",
            "includedServices": "Huduma Zilizojumuishwa:",
            "availableAmenities": "Vifaa Vinavyopatikana:",
            "travelTime": "Muda wa Safari:",
            "stopoverTime": "Muda wa Stopover:",
            "farePerPerson": "Nauli kwa Mtu:",
            "notes": "Maelezo:",
            "finalPriceNote": "Bei ni ya mwisho. Inajumuisha kodi zote.",
            "termsText": "Nimekubaliana na sheria na masharti ya usafiri. Nimeelewa kuhusu aina ya chombo, mizigo inayoruhusiwa, na huduma zilizojumuishwa kwenye nauli.",
            "luggageTerms": "Nimekubali mipaka ya mizigo (20kg kwa abiria mmoja). Mizigo ya ziada italipwa kando.",
            "continueToPassenger": "Endelea na Taarifa za Abiria",
            
            // Footer translations
            "aboutUs": "KUHUSU SISI",
            "aboutUsDesc": "GideonBooking ni mfumo wa kisasa wa upatikanaji wa tiketi kwa usafiri wa ndege, treni na basi nchini Tanzania. Tunakusudia kurahisisha usafiri wako.",
            "contactUs": "WASILIANA NASI",
            "location": "Dar es Salaam, Tanzania",
            "phone": "+255 123 456 789",
            "email": "info@gideonbooking.co.tz",
            "socialMedia": "MITANDAO YA KIJAMII",
            "socialMediaDesc": "Fuata nyuzi zetu za habari na upate ofa za kipekee.",
            "quickLinks": "VIUNGO VYA HARAKA",
            "home": "Nyumbani",
            "flights": "Ndege",
            "trains": "Treni",
            "buses": "Basi",
            "contact": "Wasiliana",
            "allRightsReserved": "Haki zote zimehifadhiwa.",
            "privacyPolicy": "Sera ya Faragha",
            "termsConditions": "Vigezo na Masharti",
            "footerNote": "Tunaendelea kuboresha huduma zetu ili kukuhudumia vyema. Asante kwa kuwa mteja wetu.",
            
            // Back button
            "backToResults": "Rudi kwenye Matokeo",
            
            // Language toggle
            "changeLanguage": "Badilisha Lugha",
            
            // Loading
            "loading": "Inapakia..."
        },
        en: {
            // Transport types
            "flight": "Flight",
            "train": "Train", 
            "bus": "Bus",
            
            // Form labels
            "systemSubtitle": "Ticket Booking System",
            "searchFlights": "Search Flights",
            "searchTrains": "Search Trains",
            "searchBuses": "Search Buses",
            "from": "From:",
            "to": "To:",
            "departureDate": "Departure Date:",
            "passengers": "Number of Passengers:",
            "passenger1": "Passenger 1",
            "passenger2": "Passenger 2",
            "passenger3": "Passenger 3",
            "passenger4": "Passenger 4",
            "passenger5": "Passenger 5",
            "search": "Search Journey",
            "searching": "Searching...",
            "selectCity": "Select city",
            "searchCity": "Search city...",
            "fieldRequired": "This field is required",
            
            // Results
            "searchResults": "Search Results",
            "noResults": "No results found",
            "noTransportFound": "No __type__ trips found on this route",
            "tryDifferent": "Please try a different route or another transport.",
            "noTripsToday": "No __type__ trips available for today",
            "noTripsAfter": "No trips starting after __time__ today.",
            "tryDifferentDate": "Please select a different date or try another transport.",
            
            // Selection
            "selectedTrip": "Your Selected Trip",
            "chooseSeat": "Choose Your Seat",
            "available": "Available",
            "selected": "Selected",
            "occupied": "Occupied",
            "emergency": "Emergency",
            "business": "Business",
            "firstClass": "First Class",
            "confirmSeat": "Confirm Seat",
            "select": "Select",
            "passenger": "Passenger",
            "passengersCount": "For __count__ passengers",
            "stopovers": "__count__ stop",
            "directFlight": "Direct",
            "stopoverFlight": "With Stops",
            "stopover": "Stopover",
            "nextDay": "+1 day",
            
            // Passenger form
            "passengerInfo": "Passenger Information",
            "passenger": "Passenger",
            "fullName": "Full Name:",
            "idNumber": "ID Number (Optional):",
            "age": "Age:",
            "gender": "Gender:",
            "chooseGender": "Choose Gender",
            "male": "Male",
            "female": "Female",
            "contactDetails": "Contact Details",
            "email": "Email:",
            "phone": "Phone Number:",
            "optional": "* This field is optional",
            "payGetTicket": "Pay & Get Ticket",
            "seatInfo": "Seat Information",
            "seatNumber": "Seat Number:",
            "firstNamePlaceholder": "First and last name",
            "idPlaceholder": "ID/Passport number (optional)",
            "agePlaceholder": "Passenger age",
            
            // Ticket
            "yourTravelTicket": "Your Travel Ticket",
            "from": "From:",
            "to": "To:",
            "departureDate": "Departure Date:",
            "departureTime": "Departure Time:",
            "transportType": "Transport Type:",
            "company": "Company:",
            "transportNumber": "__type__ Number:",
            "tripType": "Trip Type:",
            "seat": "Seat:",
            "arrivalTime": "Arrival Time:",
            "arrivalDate": "Arrival Date:",
            "passengerList": "Passenger List",
            "totalPayment": "Total Payment:",
            "contact": "Contact:",
            "thanks": "Thank you for choosing __company__. Have a safe journey!",
            "instructions": "Instructions: Arrive at the station at least 45 minutes before departure.",
            "nextDayNotice": "Notice: This trip crosses midnight and arrives the next day.",
            "printed": "Printed:",
            "printTicket": "Print Ticket",
            "scanBarcode": "Scan barcode here to verify your ticket",
            "referenceNumber": "Reference Number:",
            "years": "years",
            "checkIn": "check-in",
            
            // Notifications
            "fillRequired": "Please fill all required fields.",
            "differentCities": "You must select different cities for from and to.",
            "chooseTripFirst": "Please select a trip first.",
            "ticketSaved": "Ticket saved successfully!",
            "filledFromDeal": "Form filled automatically from deal!",
            
            // Price comparison
            "priceComparison": "Transport Price Comparison",
            "perKm": "Per kilometer:",
            
            // Bus layout
            "driverSection": "Driver Section",
            "clickToSelectSeat": "Click on the seat you want to select",
            "aisle": "Aisle",
            "selectedSeat": "Selected Seat:",
            
            // Recommended trips
            "recommendedTrips": "Recommended Trips",
            "takeThisDeal": "Take This Deal",
            "departsEvery": "Departs every",
            "departsAt": "Departs at",
            
            // Safari details
            "safariDetails": "Safari Details",
            "travelInfo": "Travel Information",
            "vehicleDetails": "Vehicle Details",
            "luggageServices": "Luggage & Services",
            "paymentDetails": "Payment Details",
            "vehicleType": "Module Type:",
            "tripNumber": "Trip Number:",
            "allowedLuggage": "Allowed Luggage:",
            "includedServices": "Included Services:",
            "availableAmenities": "Available Amenities:",
            "travelTime": "Travel Time:",
            "stopoverTime": "Stopover Time:",
            "farePerPerson": "Fare per Person:",
            "notes": "Notes:",
            "finalPriceNote": "Price is final. Includes all taxes.",
            "termsText": "I agree to the travel terms and conditions. I understand the vehicle type, allowed luggage, and services included in the fare.",
            "luggageTerms": "I accept the luggage limits. Extra luggage will be paid separately.",
            "continueToPassenger": "Continue with Passenger Details",
            
            
            // Footer translations
            "aboutUs": "ABOUT US",
            "aboutUsDesc": "GideonBooking is a modern ticket booking system for flights, trains, and buses in Tanzania. We aim to simplify your travel.",
            "contactUs": "CONTACT US",
            "location": "Dar es Salaam, Tanzania",
            "phone": "+255 123 456 789",
            "email": "info@gideonbooking.co.tz",
            "socialMedia": "SOCIAL MEDIA",
            "socialMediaDesc": "Follow our news channels and get exclusive offers.",
            "quickLinks": "QUICK LINKS",
            "home": "Home",
            "flights": "Flights",
            "trains": "Trains",
            "buses": "Buses",
            "contact": "Contact",
            "allRightsReserved": "All rights reserved.",
            "privacyPolicy": "Privacy Policy",
            "termsConditions": "Terms & Conditions",
            "footerNote": "We continuously improve our services to serve you better. Thank you for being our customer.",
            
            // Back button
            "backToResults": "Back to Results",
            
            // Language toggle
            "changeLanguage": "Change Language",
            
            // Loading
            "loading": "Loading..."
        }
    };

    // Data ya miji
    const cities = {
        "DAR": { name: "Dar es Salaam", lat: -6.7924, lng: 39.2083 },
        "JRO": { name: "Kilimanjaro", lat: -3.4294, lng: 37.0745 },
        "ZNZ": { name: "Zanzibar", lat: -5.6824, lng: 40.2083},
        "MWZ": { name: "Mwanza", lat: -2.5164, lng: 32.9176 },
        "ARK": { name: "Arusha", lat: -3.3869, lng: 36.6820 },
        "TGT": { name: "Tanga", lat: -5.0889, lng: 39.1024 },
        "DOD": { name: "Dodoma", lat: -2.7924, lng: 38.2083 },
        "MBY": { name: "Mbeya", lat: -8.9092, lng: 33.4608 },
        "MTW": { name: "Mtwara", lat: -10.2735, lng: 40.1833 },
        "KIG": { name: "Kigoma", lat: -4.8850, lng: 29.6700 },
        "TAB": { name: "Tabora", lat: -5.0209, lng: 32.8269 },
        "SON": { name: "Songea", lat: -10.6879, lng: 35.6500 },
        "BKZ": { name: "Bukoba", lat: -1.3317, lng: 21.8122 },
        "NBO": { name: "Nairobi", lat: -3.0306, lng: 33.8001 },
        "KBH": { name: "Kahama", lat: -1.7924, lng:29.2083 },
        "IRG": { name: "Iringa", lat: -2.7924, lng: 38.2083 }
    };

    // DATA KUBORESHA: Aina za vyombo kulingana na ruti
    const transportDetails = {
        flight: {
            "KQ": {
                "DAR-NBO": { 
                    planeType: "Boeing 787 Dreamliner",
                    luggage: "23kg checked + 8kg cabin",
                    services: "Chakula, vinywaji, WiFi, TV ya kibinafsi",
                    amenities: "Kiti la biashara kinapatikana",
                    stops: "30-45 dakika kwa kila stopover"
                },
                "DAR-ZNZ": { 
                    planeType: "Boeing 737-800",
                    luggage: "20kg checked + 7kg cabin",
                    services: "Chakula nyepesi, vinywaji",
                    amenities: "Huduma ya kawaida tu",
                    stops: "20 dakika kwa kila stopover"
                },
                "default": { 
                    planeType: "Boeing 737-800",
                    luggage: "20kg checked + 7kg cabin",
                    services: "Chakula nyepesi, vinywaji",
                    amenities: "Huduma ya kawaida tu",
                    stops: "25 dakika kwa kila stopover"
                }
            },
            "PW": {
                "DAR-JRO": { 
                    planeType: "ATR 72-600",
                    luggage: "20kg checked + 7kg cabin",
                    services: "Chakula nyepesi, vinywaji",
                    amenities: "Huduma ya kawaida tu",
                    stops: "30 dakika kwa kila stopover"
                },
                "DAR-MWZ": { 
                    planeType: "Bombardier Dash 8 Q400",
                    luggage: "22kg checked + 8kg cabin",
                    services: "Chakula, vinywaji",
                    amenities: "AC, viti vya kulala",
                    stops: "35 dakika kwa kila stopover"
                },
                "DAR-DOD": { 
                    planeType: "ATR 42",
                    luggage: "15kg checked + 5kg cabin",
                    services: "Vinywaji tu",
                    amenities: "Safari fupi za ndani",
                    stops: "20 dakika kwa kila stopover"
                },
                "DAR-KBH": { 
                    planeType: "Cessna Caravan",
                    luggage: "10kg total",
                    services: "Majimaji tu",
                    amenities: "Safari za kikanda",
                    stops: "15 dakika kwa kila stopover"
                },
                "default": { 
                    planeType: "ATR 72-600",
                    luggage: "20kg checked + 7kg cabin",
                    services: "Chakula nyepesi, vinywaji",
                    amenities: "Huduma ya kawaida tu",
                    stops: "30 dakika kwa kila stopover"
                }
            },
            "AT": {
                "DAR-DOD": { 
                    planeType: "Bombardier Dash 8",
                    luggage: "15kg checked + 5kg cabin",
                    services: "Vinywaji tu",
                    amenities: "Safari fupi za ndani",
                    stops: "25 dakika kwa kila stopover"
                },
                "DAR-MWZ": { 
                    planeType: "Airbus A220",
                    luggage: "25kg checked + 10kg cabin",
                    services: "Chakula kamili, vinywaji, WiFi",
                    amenities: "Mapokezi ya jikoni kwenye daraja la kwanza",
                    stops: "45 dakika kwa kila stopover"
                },
                "DAR-JRO": { 
                    planeType: "Boeing 737-800",
                    luggage: "20kg checked + 7kg cabin",
                    services: "Chakula, vinywaji",
                    amenities: "AC, TV ya kibinafsi",
                    stops: "30 dakika kwa kila stopover"
                },
                "DAR-ZNZ": { 
                    planeType: "ATR 72-600",
                    luggage: "18kg checked + 6kg cabin",
                    services: "Chakula nyepesi, vinywaji",
                    amenities: "Huduma ya kawaida",
                    stops: "20 dakika kwa kila stopover"
                },
                "default": { 
                    planeType: "Airbus A220",
                    luggage: "22kg checked + 8kg cabin",
                    services: "Chakula, vinywaji",
                    amenities: "AC, TV ya kibinafsi",
                    stops: "30 dakika kwa kila stopover"
                }
            },
            "FA": {
                "DAR-JRO": { 
                    planeType: "ATR 72-600",
                    luggage: "20kg checked + 7kg cabin",
                    services: "Chakula nyepesi, vinywaji",
                    amenities: "Huduma ya kawaida tu",
                    stops: "30 dakika kwa kila stopover"
                },
                "DAR-ARK": { 
                    planeType: "Bombardier Dash 8",
                    luggage: "15kg checked + 5kg cabin",
                    services: "Vinywaji tu",
                    amenities: "Safari fupi za ndani",
                    stops: "25 dakika kwa kila stopover"
                },
                "default": { 
                    planeType: "ATR 72-600",
                    luggage: "20kg checked + 7kg cabin",
                    services: "Chakula nyepesi, vinywaji",
                    amenities: "Huduma ya kawaida tu",
                    stops: "30 dakika kwa kila stopover"
                }
            },
            "AZ": {
                "DAR-ZNZ": { 
                    planeType: "Cessna Caravan",
                    luggage: "10kg total",
                    services: "Majimaji tu",
                    amenities: "Safari za kikanda",
                    stops: "15 dakika kwa kila stopover"
                },
                "DAR-KIG": { 
                    planeType: "Cessna Caravan",
                    luggage: "10kg total",
                    services: "Majimaji tu",
                    amenities: "Safari za kikanda",
                    stops: "15 dakika kwa kila stopover"
                },
                "DAR-ARK": { 
                    planeType: "Cessna Caravan",
                    luggage: "10kg total",
                    services: "Majimaji tu",
                    amenities: "Safari za kikanda",
                    stops: "15 dakika kwa kila stopover"
                },
                "default": { 
                    planeType: "Cessna Caravan",
                    luggage: "10kg total",
                    services: "Majimaji tu",
                    amenities: "Safari za kikanda",
                    stops: "15 dakika kwa kila stopover"
                }
            },
            "TP": {
                "DAR-ZNZ": { 
                    planeType: "Twin Otter",
                    luggage: "12kg total",
                    services: "Hakuna huduma",
                    amenities: "Safari za ndani fupi",
                    stops: "15 dakika kwa kila stopover"
                },
                "ZNZ-ARK": { 
                    planeType: "Cessna Caravan",
                    luggage: "10kg total",
                    services: "Majimaji tu",
                    amenities: "Safari za kikanda",
                    stops: "15 dakika kwa kila stopover"
                },
                "default": { 
                    planeType: "Twin Otter",
                    luggage: "12kg total",
                    services: "Hakuna huduma",
                    amenities: "Safari za ndani fupi",
                    stops: "15 dakika kwa kila stopover"
                }
            }
        },
        bus: {
            "TR": {
                "DAR-JRO": { 
                    busType: "Scania Interlink",
                    luggage: "2 mizigo kubwa + hand luggage",
                    services: "WiFi, TV, chakula nyepesi",
                    amenities: "Viti vinavyoinama, AC",
                    stops: "15-30 dakika kila 4-5 masaa"
                },
                "DAR-MBY": { 
                    busType: "Youtong Luxury Coach",
                    luggage: "2 mizigo kubwa + hand luggage",
                    services: "WiFi, TV, chakula, vinywaji",
                    amenities: "Viti vinavyoinama, blanketi",
                    stops: "30 dakika kila 5 masaa"
                },
                "default": { 
                    busType: "Scania Interlink",
                    luggage: "2 mizigo kubwa + hand luggage",
                    services: "WiFi, TV, chakula nyepesi",
                    amenities: "Viti vinavyoinama, AC",
                    stops: "15-30 dakika kila 4-5 masaa"
                }
            },
            "KM": {
                "DAR-JRO": { 
                    busType: "Toyota Coaster",
                    luggage: "1 mzigo kubwa + hand luggage",
                    services: "TV, maji",
                    amenities: "AC, viti vya kawaida",
                    stops: "20 dakika kila 4 masaa"
                },
                "default": { 
                    busType: "Toyota Coaster",
                    luggage: "1 mzigo kubwa + hand luggage",
                    services: "TV, maji",
                    amenities: "AC, viti vya kawaida",
                    stops: "20 dakika kila 4 masaa"
                }
            },
            "AA": {
                "DAR-BKZ": { 
                    busType: "MAN Lion's Coach",
                    luggage: "1 mzigo kubwa + hand luggage",
                    services: "TV, vinywaji",
                    amenities: "AC, viti vya kawaida",
                    stops: "15 dakika kila 3-4 masaa"
                },
                "default": { 
                    busType: "MAN Lion's Coach",
                    luggage: "1 mzigo kubwa + hand luggage",
                    services: "TV, vinywaji",
                    amenities: "AC, viti vya kawaida",
                    stops: "15 dakika kila 3-4 masaa"
                }
            },
            "HH": {
                "DAR-JRO": { 
                    busType: "Isuzu Gala",
                    luggage: "1 mzigo kubwa + hand luggage",
                    services: "TV, maji",
                    amenities: "AC",
                    stops: "20 dakika kila 4 masaa"
                },
                "default": { 
                    busType: "Isuzu Gala",
                    luggage: "1 mzigo kubwa + hand luggage",
                    services: "TV, maji",
                    amenities: "AC",
                    stops: "20 dakika kila 4 masaa"
                }
            },
            "KL": {
                "DAR-JRO": { 
                    busType: "Higer Luxury",
                    luggage: "2 mizigo kubwa + hand luggage",
                    services: "WiFi, TV, chakula",
                    amenities: "Viti vinavyoinama, charging ports",
                    stops: "25 dakika kila 4-5 masaa"
                },
                "default": { 
                    busType: "Higer Luxury",
                    luggage: "2 mizigo kubwa + hand luggage",
                    services: "WiFi, TV, chakula",
                    amenities: "Viti vinavyoinama, charging ports",
                    stops: "25 dakika kila 4-5 masaa"
                }
            },
            "ES": {
                "DAR-JRO": { 
                    busType: "Youtong Luxury",
                    luggage: "2 mizigo kubwa + hand luggage",
                    services: "WiFi, TV, chakula, vinywaji",
                    amenities: "Viti vinavyoinama, blanketi",
                    stops: "30 dakika kila 5 masaa"
                },
                "default": { 
                    busType: "Youtong Luxury",
                    luggage: "2 mizigo kubwa + hand luggage",
                    services: "WiFi, TV, chakula, vinywaji",
                    amenities: "Viti vinavyoinama, blanketi",
                    stops: "30 dakika kila 5 masaa"
                }
            }
        },
        train: {
            "TRC": {
                "DAR-DOD": { 
                    trainType: "SGR Modern Train",
                    luggage: "30kg checked + 10kg cabin",
                    services: "Chakula, vinywaji, WiFi, TV",
                    amenities: "Vyakula vya jikoni, viti vinavyoinama",
                    stops: "2-5 dakika kwa kila kituo"
                },
                "DAR-MBY": { 
                    trainType: "Diesel Locomotive",
                    luggage: "25kg checked + 8kg cabin",
                    services: "Chakula nyepesi, vinywaji",
                    amenities: "Viti vinavyoinama",
                    stops: "5-10 dakika kwa kila kituo"
                },
                "default": { 
                    trainType: "SGR Modern Train",
                    luggage: "30kg checked + 10kg cabin",
                    services: "Chakula, vinywaji, WiFi, TV",
                    amenities: "Vyakula vya jikoni, viti vinavyoinama",
                    stops: "2-5 dakika kwa kila kituo"
                }
            }
        }
    };

    // Function to get vehicle details based on route
    function getVehicleDetails(transportType, companyId, from, to) {
        const routeKey = `${from}-${to}`;
        const reverseRouteKey = `${to}-${from}`;
        
        const companyDetails = transportDetails[transportType] ? transportDetails[transportType][companyId] : null;
        
        if (!companyDetails) {
            return {
                planeType: currentLanguage === 'sw' ? 'Hakuna taarifa' : 'No information',
                luggage: currentLanguage === 'sw' ? '20kg kwa kawaida' : '20kg standard',
                services: currentLanguage === 'sw' ? 'Huduma za kawaida' : 'Standard services',
                amenities: currentLanguage === 'sw' ? 'Hakuna maelezo' : 'No details', 
                stops: currentLanguage === 'sw' ? '15-30 dakika' : '15-30 minutes'
            };
        }
        
        // Check for exact route
        if (companyDetails[routeKey]) {
            return companyDetails[routeKey];
        }
        
        // Check for reverse route
        if (companyDetails[reverseRouteKey]) {
            return companyDetails[reverseRouteKey];
        }
        
        // Use default if available
        if (companyDetails.default) {
            return companyDetails.default;
        }
        
        // Fallback to general default
        return {
            planeType: currentLanguage === 'sw' ? 'Hakuna taarifa' : 'No information',
            luggage: currentLanguage === 'sw' ? '20kg kwa kawaida' : '20kg standard',
            services: currentLanguage === 'sw' ? 'Huduma za kawaida' : 'Standard services',
            amenities: currentLanguage === 'sw' ? 'Hakuna maelezo' : 'No details',
            stops: currentLanguage === 'sw' ? '15-30 dakika' : '15-30 minutes'
        };
    }

    // Constants for price calculation
    const PRICE_PER_KM = {
        flight: {
            "KQ": 400,
            "PW": 350,
            "AT": 320,
            "FA": 380,
            "AZ": 300,
            "TP": 380
        },
        train: {
            "TRC": 120,
            "TAR": 110
        },
        bus: {
            "SC": 85,
            "KM": 75,
            "AA": 70,
            "HH": 80
        }
    };

    // Base prices for minimum distances
    const BASE_PRICES = {
        flight: 50000,
        train: 15000,
        bus: 8000
    };

    // Data ya kampuni za ndege
    const flightCompanies = [
        {
            id: "KQ",
            name: "Kenya Airways",
            logo: "KQ.png",
            routes: ["DAR", "NBO", "ZNZ"],
            flights: [
                {
                    code: "KQ 237",
                    route: "DAR-NBO",
                    departureTime: "10:00",
                    stops: ["ZNZ"],
                    isDirect: false
                },
                {
                    code: "KQ 365",
                    route: "NBO-DAR",
                    departureTime: "06:30",
                    stops: ["ZNZ"],
                    isDirect: false
                },
                {
                    code: "KQ 712",
                    route: "NBO-ZNZ",
                    departureTime: "06:30",
                    stops: [],
                    isDirect: true
                }
            ]
        },
        {
            id: "PW",
            name: "Precision Air",
            logo: "PW.png",
            routes: ["DAR", "JRO", "ZNZ", "MWZ", "ARK", "DOD", "MBY", "MTW", "TAB", "BKZ","NBO", "TGT", "KBH", "IRG"],
            flights: [
                {
                    code: "PW 718",
                    route: "NBO-DAR",
                    departureTime: "07:15",
                    stops: ["JRO", "ZNZ"],
                    isDirect: false
                },
                {
                    code: "PW 467",
                    route: "DAR-KBH",
                    departureTime: "06:00",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "PW 600",
                    route: "DAR-DOD",
                    departureTime: "06:00",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "PW 615",
                    route: "IRG-DAR",
                    departureTime: "08:55",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "PW 614",
                    route: "DAR-IRG",
                    departureTime: "07:30",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "PW 467",
                    route: "KBH-DAR",
                    departureTime: "06:00",
                    stops: ["MWZ"],
                    isDirect: false
                },
                {
                    code: "PW 717",
                    route: "DAR-NBO",
                    departureTime: "05:00",
                    stops: ["JRO"],
                    isDirect: false
                },
                {
                    code: "PW 422",
                    route: "DAR-JRO",
                    departureTime: "10:00",
                    stops: ["ZNZ"],
                    isDirect: false
                },
                {
                    code: "PW 437",
                    route: "JRO-DAR",
                    departureTime: "16:00",
                    stops: ["ZNZ"],
                    isDirect: false
                },
                {
                    code: "PW 436",
                    route: "DAR-JRO", 
                    departureTime: "14:30",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "PW 423",
                    route: "JRO-DAR",
                    departureTime: "10:00",
                    stops: ["ZNZ"],
                    isDirect: false
                },
                {
                    code: "PW 101",
                    route: "DAR-ZNZ",
                    departureTime: "08:15",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "PW 202",
                    route: "DAR-MWZ",
                    departureTime: "11:45",
                    stops: ["DOD"],
                    isDirect: false
                },
                {
                    code: "PW 303",
                    route: "DAR-MWZ",
                    departureTime: "16:20",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "PW 404",
                    route: "DAR-ARK",
                    departureTime: "07:30",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "PW 505",
                    route: "DAR-TGT",
                    departureTime: "13:15",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "PW 212",
                    route: "DAR-BKZ",
                    departureTime: "12:10",
                    stops: ["MWZ"],
                    isDirect: true
                },
                {
                    code: "PW 213",
                    route: "BKZ-DAR",
                    departureTime: "16:00",
                    stops: ["MWZ"],
                    isDirect: true
                }
            ]
        },
        {
            id: "AT",
            name: "Air Tanzania",
            logo: "TC.png",
            routes: ["DAR", "JRO", "ZNZ", "MWZ", "ARK", "DOD", "MBY", "TAB", "SON","NBO","BKZ"],
            flights: [
                {
                    code: "TC 101",
                    route: "DAR-MWZ",
                    departureTime: "09:30",
                    stops: ["JRO"],
                    isDirect: true
                },
                {
                    code: "TC 102",
                    route: "DAR-JRO",
                    departureTime: "17:45",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "TC 201",
                    route: "DAR-ZNZ",
                    departureTime: "07:00",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "TC 202",
                    route: "DAR-NBO",
                    departureTime: "15:30",
                    stops: ["ZNZ"],
                    isDirect: false
                },
                {
                    code: "TC 301",
                    route: "DAR-MWZ",
                    departureTime: "13:15",
                    stops: ["DOD"],
                    isDirect: false
                },
                {
                    code: "TC 302",
                    route: "DAR-BKZ",
                    departureTime: "09:00",
                    stops: ["MWZ"],
                    isDirect: true
                },
                {
                    code: "TC 303",
                    route: "BKZ-DAR",
                    departureTime: "13:00",
                    stops: ["MWZ"],
                    isDirect: true
                }
            ]
        },
        {
            id: "FA",
            name: "Flight Link",
            logo: "FL.png",
            routes: ["DAR", "JRO", "ZNZ", "MWZ", "ARK", "MBY", "NBO"],
            flights: [
                {
                    code: "FL 101",
                    route: "DAR-JRO",
                    departureTime: "12:00",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "FL 145",
                    route: "DAR-NBO",
                    departureTime: "16:00",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "FL 237",
                    route: "DAR-ARK",
                    departureTime: "12:00",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "FL 731",
                    route: "DAR-MBY",
                    departureTime: "12:00",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "FL 144",
                    route: "NBO-DAR",
                    departureTime: "17:45",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "FL 102",
                    route: "DAR-JRO",
                    departureTime: "19:30",
                    stops: ["ZNZ"],
                    isDirect: true
                },
                {
                    code: "FL 201",
                    route: "DAR-MWZ",
                    departureTime: "10:45",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "FL 202",
                    route: "DAR-ZNZ",
                    departureTime: "16:15",
                    stops: [],
                    isDirect: true
                }
            ]
        },
        {
            id: "AZ",
            name: "Auric Air",
            logo: "UI (1).png",
            routes: ["DAR", "ZNZ", "ARK", "TGT", "MTW", "KIG", "TAB", "SON", "IRG"],
            flights: [
                {
                    code: "AU 101",
                    route: "DAR-ZNZ",
                    departureTime: "08:30",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "AU 731",
                    route: "DAR-KIG",
                    departureTime: "08:30",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "AU 141",
                    route: "DAR-MTW",
                    departureTime: "08:30",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "AU 357",
                    route: "DAR-SON",
                    departureTime: "12:30",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "AU 102",
                    route: "DAR-ZNZ",
                    departureTime: "14:00",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "AU 214",
                    route: "DAR-TAB",
                    departureTime: "11:00",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "AU 202",
                    route: "DAR-ARK",
                    departureTime: "16:45",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "AU 232",
                    route: "DAR-IRG",
                    departureTime: "13:45",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "AU 233",
                    route: "IRG-DAR",
                    departureTime: "15:10",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "AU 315",
                    route: "DAR-TGT",
                    departureTime: "14:15",
                    stops: [],
                    isDirect: true
                }
            ]
        },
        {
        id: "TP",
        name: "Tropical Air",
        logo: "Tropical.png",
        routes: ["DAR", "ZNZ", "ARK", "TGT", "MTW", "KIG", "TAB", "SON", "IRG"],
        flights: [
            {
                code: "TP 451",
                route: "DAR-ZNZ",
                departureTime: "08:30",
                stops: [],
                isDirect: true
            },
            {
                code: "TP 601",
                route: "ZNZ-ARK",
                departureTime: "08:30",
                stops: [],
                isDirect: true
            }
        ]
    
    }
    ];

    // Data ya kampuni za treni
    const trainCompanies = [
        {
            id: "TRC",
            name: "SGR",
            logo: "SGR.png",
            routes: ["DAR", "DOD", "TAB", "KIG", "MBY", "SON", "MTW", "TGT"],
            schedules: [
                {
                    code: "TR101",
                    route: "DAR-DOD",
                    departureTime: "08:00",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "TR102",
                    route: "DAR-DOD", 
                    departureTime: "16:30",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "TR201",
                    route: "DAR-MBY",
                    departureTime: "07:15",
                    stops: ["DOD", "TAB"],
                    isDirect: false
                },
                {
                    code: "TR202",
                    route: "DAR-MBY",
                    departureTime: "18:45",
                    stops: ["DOD"],
                    isDirect: false
                }
            ]
        }
    ];

    // Data ya kampuni za basi
    const busCompanies = [
        {
            id: "TR",
            name: "Tirisho",
            logo: "TRS.webp",
            routes: ["DAR", "JRO", "ARK", "MWZ", "MBY", "SON", "MTW", "TGT", "DOD"],
            schedules: [
                {
                    code: "T501EHC",
                    route: "DAR-JRO",
                    departureTime: "07:30",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "T502EHH",
                    route: "DAR-MBY",
                    departureTime: "14:00",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "T503EHD",
                    route: "DAR-ARK",
                    departureTime: "20:30",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "T533EHC",
                    route: "DAR-TGT",
                    departureTime: "12:30",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "T512EEQ",
                    route: "DAR-MWZ",
                    departureTime: "08:45",
                    stops: [],
                    isDirect: true
                }
            ]
        },
        {
            id: "KM",
            name: "Katalama Express",
            logo: "kata.png",
            routes: ["DAR", "JRO", "ARK", "MWZ", "MBY", "TGT", "DOD"],
            schedules: [
                {
                    code: "T519EHJ",
                    route: "DAR-JRO",
                    departureTime: "06:00",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "T552EDP",
                    route: "DAR-JRO",
                    departureTime: "13:30",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "T103EEK",
                    route: "DAR-JRO",
                    departureTime: "18:00",
                    stops: [],
                    isDirect: true
                }
            ]
        },
        {
            id: "AA",
            name: "Abood Bus",
            logo: "abood.png",
            routes: ["DAR", "JRO", "ARK", "MWZ", "MBY", "SON", "MTW", "TGT", "DOD", "BKZ"],
            schedules: [
                {
                    code: "T301EEB",
                    route: "DAR-BKZ",
                    departureTime: "07:00",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "T712EET",
                    route: "DAR-JRO",
                    departureTime: "15:45",
                    stops: [],
                    isDirect: true
                }
            ]
        },
        {
            id: "HH",
            name: "City Boy",
            logo: "cit.png",
            routes: ["DAR", "JRO", "ARK", "MWZ", "MBY", "SON", "MTW", "TGT", "DOD"],
            schedules: [
                {
                    code: "T981EEJ",
                    route: "DAR-JRO",
                    departureTime: "08:15",
                    stops: [],
                    isDirect: true
                },
                {
                    code: "T562EBU",
                    route: "DAR-JRO",
                    departureTime: "16:30",
                    stops: [],
                    isDirect: true
                }
            ]
        },
        {
            id: "KL",
            name: "Kilimanjaro",
            logo: "JRO.png",
            routes: ["DAR", "JRO", "ARK", "MWZ", "MBY", "SON", "MTW", "TGT", "DOD"],
            schedules: [
                {
                    code: "T981EEJ",
                    route: "DAR-JRO",
                    departureTime: "08:15",
                    stops: [],
                    isDirect: true
                },
            ]
        },
        {
            id: "ES",
            name: "Ester",
            logo: "EST.png",
            routes: ["DAR", "JRO", "ARK", "MWZ", "MBY", "SON", "MTW", "TGT", "DOD"],
            schedules: [
                {
                    code: "T981EEJ",
                    route: "DAR-JRO",
                    departureTime: "08:15",
                    stops: [],
                    isDirect: true
                },
            ]
        }   
    ];

    // Vigezo vya hali ya mfumo
    let currentTransportType = "flight";
    let currentLanguage = 'sw';
    let currentSearchData = {}; // Kuhifadhi data ya utaftuaji sasa

    // Initialize the application
    document.addEventListener('DOMContentLoaded', function() {
        // Set minimum date to today
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('departure').setAttribute('min', today);
        document.getElementById('departure').value = today;
        
        // Initialize enhanced searchable dropdowns
        initializeEnhancedDropdowns();
        
        // Setup print events
        setupPrintEvents();
        
        // Load recommended trips
        loadRecommendedTrips();
        
        // Add event listeners to language buttons (desktop)
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const lang = this.dataset.lang;
                switchLanguage(lang);
                
                // Update active state
                document.querySelectorAll('.lang-btn').forEach(b => {
                    b.classList.remove('active');
                });
                this.classList.add('active');
            });
        });
        
        // Add event listeners to mobile language buttons
        document.querySelectorAll('.mobile-lang-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const lang = this.dataset.lang;
                switchLanguage(lang);
                
                // Update active state in mobile dropdown
                document.querySelectorAll('.mobile-lang-btn').forEach(b => {
                    b.classList.remove('active');
                });
                this.classList.add('active');
                
                // Close mobile dropdown
                document.getElementById('mobile-language-dropdown').classList.remove('show');
            });
        });
        
        // Add event listener to language toggle button (mobile)
        document.getElementById('language-toggle').addEventListener('click', function(e) {
            e.stopPropagation();
            const dropdown = document.getElementById('mobile-language-dropdown');
            dropdown.classList.toggle('show');
        });
        
        // Close language dropdown when clicking outside
        document.addEventListener('click', function(e) {
            const dropdown = document.getElementById('mobile-language-dropdown');
            const toggleBtn = document.getElementById('language-toggle');
            
            if (dropdown && toggleBtn) {
                if (!dropdown.contains(e.target) && !toggleBtn.contains(e.target)) {
                    dropdown.classList.remove('show');
                }
            }
        });
        
        // Add event listeners to transport type buttons
        document.querySelectorAll('.transport-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.transport-btn').forEach(b => {
                    b.classList.remove('active');
                });
                this.classList.add('active');
                
                // Update form title based on transport type and language
                const transportType = this.dataset.type;
                updateFormTitle(transportType);
                
                currentTransportType = transportType;
                
                // Rudi kwenye fomu ya kwanza na kuonyesha fomu
                resetToBookingForm();
            });
        });
        
        // Add event listener to search button
        document.getElementById('search-btn').addEventListener('click', function() {
            const from = document.querySelector('#from-dropdown .dropdown-input').getAttribute('data-value');
            const to = document.querySelector('#to-dropdown .dropdown-input').getAttribute('data-value');
            const date = document.getElementById('departure').value;
            const passengers = document.getElementById('passengers').value;
            
            // Validate form
            if (!validateSearchForm(from, to, date)) {
                return;
            }
            
            // Save current search data
            currentSearchData = { from, to, date, passengers };
            
            // Hide previous results before showing new ones
            resetAllSections();
            
            // Show loading state
            showLoading(true);
            
            // Show search spinner for at least 1 second
            const searchSpinner = document.getElementById('search-spinner');
            searchSpinner.style.display = 'block';
            
            // Disable search button during search
            const searchBtn = document.getElementById('search-btn');
            searchBtn.disabled = true;
            searchBtn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> ${translations[currentLanguage].searching}`;
            
            // Simulate loading delay for better UX (minimum 1 second)
            setTimeout(() => {
                showAvailableOptions(from, to, date, passengers);
                
                // Hide spinner and re-enable button
                searchSpinner.style.display = 'none';
                searchBtn.disabled = false;
                searchBtn.innerHTML = `<i class="fas fa-search"></i> ${translations[currentLanguage].search}`;
                // Sehemu ya kadi katika showAvailableOptions() function

    
                
                showLoading(false);
            }, 1000);
        });

        // Add event listener to book ticket button
        document.getElementById('book-ticket-btn').addEventListener('click', function() {
            const passengerCount = parseInt(document.getElementById('passengers').value);
            
            if (!validatePassengerForm(passengerCount)) {
                showNotification(translations[currentLanguage].fillRequired, 'error');
                return;
            }
            
            // Get all the necessary data for generating ticket
            const transportType = document.querySelector('.transport-btn.active').dataset.type;
            const from = document.querySelector('#from-dropdown .dropdown-input').getAttribute('data-value');
            const to = document.querySelector('#to-dropdown .dropdown-input').getAttribute('data-value');
            const date = document.getElementById('departure').value;
            const passengers = document.getElementById('passengers').value;
            
            if (!window.selectedCompany || !window.selectedPrice) {
                showNotification(translations[currentLanguage].chooseTripFirst, 'error');
                return;
            }
            
            // Show loading
            showLoading(true);
            
            // Generate the ticket
            generateTicket(transportType, window.selectedCompany, from, to, date, passengers, window.selectedPrice, window.selectedSeat);
        });

        // Reset border colors when input fields are focused
        document.querySelectorAll('input, select').forEach(input => {
            input.addEventListener('focus', function() {
                this.style.borderColor = '';
                const formGroup = this.closest('.form-group');
                if (formGroup && formGroup.classList.contains('error')) {
                    formGroup.classList.remove('error');
                }
            });
        });
        
        // Initialize global variables
        window.selectedCompany = null;
        window.selectedFlight = null;
        window.selectedPrice = null;
        window.selectedSeat = null;
        
        // Add event listener to back button
        document.getElementById('back-to-results-btn').addEventListener('click', function() {
            goBackToResults();
        });
        
        // Show/hide language buttons based on screen size
        updateLanguageButtonVisibility();
        window.addEventListener('resize', updateLanguageButtonVisibility);
        
        // Close dropdowns when clicking escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                document.getElementById('mobile-language-dropdown').classList.remove('show');
            }
        });
    });

    // Function to update language button visibility based on screen size
    function updateLanguageButtonVisibility() {
        const isMobile = window.innerWidth <= 768;
        const desktopLangBtns = document.querySelectorAll('.lang-btn');
        const mobileToggle = document.querySelector('.language-toggle');
        
        if (isMobile) {
            // On mobile: hide desktop buttons, show mobile toggle
            desktopLangBtns.forEach(btn => {
                btn.style.display = 'none';
            });
            if (mobileToggle) mobileToggle.style.display = 'flex';
        } else {
            // On desktop: show desktop buttons, hide mobile toggle
            desktopLangBtns.forEach(btn => {
                btn.style.display = 'inline-block';
            });
            if (mobileToggle) mobileToggle.style.display = 'none';
            // Also hide mobile dropdown if open
            const dropdown = document.getElementById('mobile-language-dropdown');
            if (dropdown) dropdown.classList.remove('show');
        }
    }

    // Function to reset to booking form
    function resetToBookingForm() {
        // Hide all sections except the booking form and recommended trips
        document.getElementById('price-comparison').style.display = 'none';
        document.getElementById('results-section').style.display = 'none';
        document.getElementById('selected-option').style.display = 'none';
        document.getElementById('seat-selection').style.display = 'none';
        document.getElementById('safari-details').style.display = 'none';
        document.getElementById('passenger-form').style.display = 'none';
        document.getElementById('ticket-display').style.display = 'none';
        
        // Show booking form and recommended trips
        document.querySelector('.booking-form').style.display = 'block';
        document.querySelector('.recommended-trips').style.display = 'block';
        
        // Scroll to booking form
        document.querySelector('.booking-form').scrollIntoView({ behavior: 'smooth' });
        
        // Reset selection variables
        window.selectedCompany = null;
        window.selectedFlight = null;
        window.selectedPrice = null;
        window.selectedSeat = null;
    }

    // Function to go back to results
    function goBackToResults() {
        // Hide current section
        document.getElementById('safari-details').style.display = 'none';
        
        // Show results section
        document.getElementById('results-section').style.display = 'block';
        
        // Scroll to results
        document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });
        
        // Reset seat selection if applicable
        window.selectedSeat = null;
    }

    // Function to switch language
    function switchLanguage(lang) {
        currentLanguage = lang;
        updateLanguage();
        loadRecommendedTrips(); // Reload recommended trips in new language
        
        // Update back button text
        const backBtn = document.getElementById('back-to-results-btn');
        if (backBtn) {
            backBtn.innerHTML = `
                <i class="fas fa-arrow-left"></i> ${translations[currentLanguage].backToResults}
            `;
        }
        
        // Also update desktop language buttons
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.classList.remove('active');
            if (btn.dataset.lang === lang) {
                btn.classList.add('active');
            }
        });
        
        // Update transport button text
        document.querySelectorAll('.transport-text').forEach((span, index) => {
            const types = ['flight', 'train', 'bus'];
            if (index < types.length) {
                span.textContent = translations[lang][types[index]];
            }
        });
    }

    // Function to update all text in the interface
    function updateLanguage() {
        const t = translations[currentLanguage];
        
        // Update system subtitle
        document.querySelector('.system-subtitle').textContent = t.systemSubtitle;
        
        // Update transport buttons text via spans
        const transportTexts = document.querySelectorAll('.transport-text');
        transportTexts[0].textContent = t.flight;
        transportTexts[1].textContent = t.train;
        transportTexts[2].textContent = t.bus;
        
        // Update form title
        updateFormTitle(currentTransportType);
        
        // Update form labels
        document.querySelectorAll('[data-i18n="from"]').forEach(el => el.textContent = t.from);
        document.querySelectorAll('[data-i18n="to"]').forEach(el => el.textContent = t.to);
        document.querySelectorAll('[data-i18n="departureDate"]').forEach(el => el.textContent = t.departureDate);
        document.querySelectorAll('[data-i18n="passengers"]').forEach(el => el.textContent = t.passengers);
        
        // Update passenger options
        document.querySelectorAll('[data-i18n="passenger1"]').forEach(el => el.textContent = t.passenger1);
        document.querySelectorAll('[data-i18n="passenger2"]').forEach(el => el.textContent = t.passenger2);
        document.querySelectorAll('[data-i18n="passenger3"]').forEach(el => el.textContent = t.passenger3);
        document.querySelectorAll('[data-i18n="passenger4"]').forEach(el => el.textContent = t.passenger4);
        document.querySelectorAll('[data-i18n="passenger5"]').forEach(el => el.textContent = t.passenger5);
        
        // Update search button
        const searchBtn = document.getElementById('search-btn');
        if (searchBtn) {
            searchBtn.innerHTML = `<i class="fas fa-search"></i> ${t.search}`;
        }
        
        // Update dropdown placeholders
        document.querySelectorAll('.search-input').forEach(input => {
            input.placeholder = t.searchCity;
        });
        
        // Update dropdown selected texts if they are the default placeholder
        document.querySelectorAll('.searchable-dropdown .dropdown-input .selected-text').forEach(el => {
            if (el.textContent.includes('Chagua mji') || el.textContent.includes('Select city') || el.getAttribute('data-i18n') === 'selectCity') {
                el.textContent = t.selectCity;
            }
        });
        
        // Update field required messages
        document.querySelectorAll('[data-i18n="fieldRequired"]').forEach(el => {
            el.textContent = t.fieldRequired;
        });
        
        // Update footer translations
        updateFooterLanguage();
        
        // Update back button text
        const backBtn = document.getElementById('back-to-results-btn');
        if (backBtn) {
            backBtn.innerHTML = `
                <i class="fas fa-arrow-left"></i> ${t.backToResults}
            `;
        }
        
        // Update loading text
        document.querySelectorAll('[data-i18n="loading"]').forEach(el => {
            el.textContent = t.loading;
        });
    }

    // Function to update footer language
    function updateFooterLanguage() {
        const t = translations[currentLanguage];
        
        // Update all elements with data-i18n attribute in footer
        document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.getAttribute('data-i18n');
            if (t[key]) {
                element.textContent = t[key];
            }
        });
        
        // Update placeholder attributes
        document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
            const key = element.getAttribute('data-i18n-placeholder');
            if (t[key]) {
                element.setAttribute('placeholder', t[key]);
            }
        });
    }

    // Function to update form title based on transport type
    function updateFormTitle(transportType) {
        const formTitle = document.getElementById('form-title');
        const t = translations[currentLanguage];
        
        if (formTitle) {
            switch(transportType) {
                case "flight":
                    formTitle.textContent = t.searchFlights;
                    break;
                case "train":
                    formTitle.textContent = t.searchTrains;
                    break;
                case "bus":
                    formTitle.textContent = t.searchBuses;
                    break;
            }
        }
    }

    // Function to initialize enhanced searchable dropdowns
    function initializeEnhancedDropdowns() {
        const dropdowns = document.querySelectorAll('.searchable-dropdown');
        
        dropdowns.forEach(dropdown => {
            const input = dropdown.querySelector('.dropdown-input');
            const optionsContainer = dropdown.querySelector('.dropdown-options');
            const searchInput = dropdown.querySelector('.search-input');
            const optionsList = dropdown.querySelector('.dropdown-options-list');
            
            // Add options to dropdown
            let optionsHTML = '';
            for (const code in cities) {
                optionsHTML += `<div class="dropdown-option" data-value="${code}">${cities[code].name} <span class="city-code">(${code})</span></div>`;
            }
            optionsList.innerHTML = optionsHTML;
            
            // Re-select elements after updating HTML
            const options = dropdown.querySelectorAll('.dropdown-option');
            
            // Enhanced search functionality
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                let hasResults = false;
                
                options.forEach(option => {
                    const text = option.textContent.toLowerCase();
                    if (text.includes(searchTerm)) {
                        option.style.display = 'block';
                        hasResults = true;
                    } else {
                        option.style.display = 'none';
                    }
                });
                
                // Show no results message if no matches
                let noResults = optionsContainer.querySelector('.no-results');
                if (!hasResults) {
                    if (!noResults) {
                        noResults = document.createElement('div');
                        noResults.className = 'no-results';
                        noResults.textContent = translations[currentLanguage].noResults;
                        optionsContainer.appendChild(noResults);
                    }
                } else if (noResults) {
                    noResults.remove();
                }
            });
            
            // Rest of the dropdown functionality
            input.addEventListener('click', function(e) {
                e.stopPropagation();
                const isOpen = optionsContainer.classList.contains('open');
                
                document.querySelectorAll('.dropdown-options').forEach(container => {
                    container.classList.remove('open');
                });
                document.querySelectorAll('.dropdown-input').forEach(inp => {
                    inp.classList.remove('open');
                });
                
                if (!isOpen) {
                    optionsContainer.classList.add('open');
                    input.classList.add('open');
                    searchInput.focus();
                }
            });
            
            options.forEach(option => {
                option.addEventListener('click', function() {
                    const selectedText = this.textContent;
                    const selectedValue = this.getAttribute('data-value');
                    
                    input.querySelector('.selected-text').textContent = selectedText;
                    input.setAttribute('data-value', selectedValue);
                    
                    optionsContainer.classList.remove('open');
                    input.classList.remove('open');
                    
                    validateCitySelection();
                });
            });
            
            document.addEventListener('click', function() {
                optionsContainer.classList.remove('open');
                input.classList.remove('open');
            });
        });
        
        // Set default values
        document.querySelector('#from-dropdown .dropdown-input .selected-text').textContent = translations[currentLanguage].selectCity;
        document.querySelector('#from-dropdown .dropdown-input').setAttribute('data-value', '');
        
        document.querySelector('#to-dropdown .dropdown-input .selected-text').textContent = translations[currentLanguage].selectCity;
        document.querySelector('#to-dropdown .dropdown-input').setAttribute('data-value', '');
        
        // Initialize footer language
        updateFooterLanguage();
    }

    // Function to setup print events
    function setupPrintEvents() {
        // Before print
        window.addEventListener('beforeprint', function() {
            document.body.classList.add('printing');
            
            const elementsToHide = [
                '.transport-options',
                '.booking-form',
                '.price-comparison',
                '.results-section',
                '.selected-option',
                '.seat-selection',
                '.safari-details',
                '.passenger-form',
                'header',
                '.notification',
                '.loading-overlay'
            ];
            
            elementsToHide.forEach(selector => {
                const elements = document.querySelectorAll(selector);
                elements.forEach(el => {
                    el.style.display = 'none';
                });
            });
        });
        
        // After print
        window.addEventListener('afterprint', function() {
            document.body.classList.remove('printing');
            
            const elementsToShow = [
                '.transport-options',
                '.booking-form',
                'header'
            ];
            
            elementsToShow.forEach(selector => {
                const elements = document.querySelectorAll(selector);
                elements.forEach(el => {
                    el.style.display = '';
                });
            });
        });
    }

    // Function to load recommended trips
    function loadRecommendedTrips() {
        const recommendedTrips = [
            {
                route: "Dar es Salaam â†’ Zanzibar",
                type: "flight",
                company: "Precision Air",
                price: 120000,
                description: currentLanguage === 'sw' ? "Safari ya ndege ya saa 0:30, tiketi zenye ukomo" : "30-minute flight, limited tickets",
                departure: currentLanguage === 'sw' ? "Kila saa 2" : "Every 2 hours",
                duration: currentLanguage === 'sw' ? "30 dakika" : "30 minutes"
            },
             {
                route: "Dar es Salaam â†’ Dodoma",
                type: "train",
                company: "SGR",
                price: 50000,
                description: currentLanguage === 'sw' ? "Safari ya train ya mwendo kasi ya saa 0:45" : "45-minute train, limited tickets",
                departure: currentLanguage === 'sw' ? "Kila saa 2" : "Every 2 hours",
                duration: currentLanguage === 'sw' ? "45 dakika" : "45 minutes"
            },
            {
                route: "Dar es Salaam â†’ Arusha",
                type: "bus",
                company: "Scandinavian Express",
                price: 45000,
                description: currentLanguage === 'sw' ? "Basi la fujo la usiku, viti vya kulala" : "Night luxury bus, sleeping seats",
                departure: currentLanguage === 'sw' ? "Saa 8:00 jioni" : "8:00 PM",
                duration: currentLanguage === 'sw' ? "8 masaa" : "8 hours"
            },
            {
                route: "Dar es Salaam â†’ Mwanza",
                type: "flight",
                company: "Air Tanzania",
                price: 250000,
                description: currentLanguage === 'sw' ? "Safari ya moja kwa moja, chakula kinajumuishwa" : "Direct flight, meals included",
                departure: currentLanguage === 'sw' ? "Saa 7:00 asubuhi" : "7:00 AM",
                duration: currentLanguage === 'sw' ? "1 saa 45 dakika" : "1 hour 45 minutes"
            },
            {
                route: "Dar es Salaam â†’ Mbeya",
                type: "bus",
                company: "Kilimanjaro Express",
                price: 55000,
                description: currentLanguage === 'sw' ? "Basi la hali ya juu, TV na WiFi" : "Premium bus with TV and WiFi",
                departure: currentLanguage === 'sw' ? "Saa 10:00 asubuhi" : "10:00 AM",
                duration: currentLanguage === 'sw' ? "12 masaa" : "12 hours"
            },
             {
                route: "Zanzibar â†’ Arusha",
                type: "flight",
                company: "Tropical Air",
                price: 177000,
                description: currentLanguage === 'sw' ? "Safari ya ndege ya saa 0:45, tiketi zenye ukomo" : "30-minute flight, limited tickets",
                departure: currentLanguage === 'sw' ? "Kila siku" : "Every Day",
                duration: currentLanguage === 'sw' ? "45 dakika" : "45 minutes"
            }
        ];

        const grid = document.getElementById('recommended-grid');
        const t = translations[currentLanguage];
        
        // Update title
        document.querySelector('.recommended-title').innerHTML = `<i class="fas fa-fire"></i> ${t.recommendedTrips}`;
        
        grid.innerHTML = '';
        
        recommendedTrips.forEach(trip => {
            const icon = trip.type === 'flight' ? '<i class="fas fa-plane-departure"></i>' : trip.type === 'train' ? '<i class="fas fa-train"></i>' : '<i class="fas fa-bus"></i>';
            const typeText = trip.type === 'flight' ? t.flight : trip.type === 'train' ? t.train : t.bus;
            
            grid.innerHTML += `
                <div class="recommended-card">
                    <div class="recommended-header">
                        <div class="recommended-type">${icon} ${typeText}</div>
                        <div class="recommended-price">TZS ${trip.price.toLocaleString()}</div>
                    </div>
                    <div class="recommended-body">
                        <div class="recommended-route">${trip.route}</div>
                        <div class="recommended-details">
                            <span><i class="fas fa-building"></i> ${trip.company}</span>
                            <span><i class="fas fa-clock"></i> ${trip.duration}</span>
                        </div>
                        <p class="recommended-description">${trip.description}</p>
                        <p><i class="fas fa-calendar-alt"></i> <strong>${t.departsAt}:</strong> ${trip.departure}</p>
                        <button class="book-now-btn" onclick="selectRecommendedTrip('${trip.route.split(' â†’ ')[0]}', '${trip.route.split(' â†’ ')[1]}', '${trip.type}')">
                            <i class="fas fa-shopping-cart"></i> ${t.takeThisDeal}
                        </button>
                    </div>
                </div>
            `;
        });
    }

    // Function to handle recommended trip selection
    function selectRecommendedTrip(fromCity, toCity, transportType) {
        // Find city codes
        const fromCode = Object.keys(cities).find(code => 
            cities[code].name === fromCity || 
            (fromCity.includes("Dar es Salaam") && code === "DAR") ||
            (fromCity.includes("Zanzibar") && code === "ZNZ") ||
            (fromCity.includes("Arusha") && code === "ARK") ||
            (fromCity.includes("Mwanza") && code === "MWZ") ||
            (fromCity.includes("Mbeya") && code === "MBY")
        );
        
        const toCode = Object.keys(cities).find(code => 
            cities[code].name === toCity ||
            (toCity.includes("Dar es Salaam") && code === "DAR") ||
            (toCity.includes("Zanzibar") && code === "ZNZ") ||
            (toCity.includes("Arusha") && code === "ARK") ||
            (toCity.includes("Mwanza") && code === "MWZ") ||
            (toCity.includes("Mbeya") && code === "MBY")
        );
        
        if (fromCode && toCode) {
            // Set dropdown values
            document.querySelector('#from-dropdown .dropdown-input .selected-text').textContent = cities[fromCode].name;
            document.querySelector('#from-dropdown .dropdown-input').setAttribute('data-value', fromCode);
            
            document.querySelector('#to-dropdown .dropdown-input .selected-text').textContent = cities[toCode].name;
            document.querySelector('#to-dropdown .dropdown-input').setAttribute('data-value', toCode);
            
            // Set transport type
            document.querySelectorAll('.transport-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.type === transportType) {
                    btn.classList.add('active');
                    currentTransportType = transportType;
                    updateFormTitle(transportType);
                }
            });
            
            // Set departure date to tomorrow
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            document.getElementById('departure').value = tomorrow.toISOString().split('T')[0];
            
            // Show success message
            showNotification(translations[currentLanguage].filledFromDeal, 'success');
            
            // Scroll to booking form
            document.querySelector('.booking-form').scrollIntoView({ behavior: 'smooth' });
        }
    }

    // Function to reset all sections when a new search is performed
    function resetAllSections() {
        document.getElementById('price-comparison').style.display = 'none';
        document.getElementById('results-section').style.display = 'none';
        document.getElementById('selected-option').style.display = 'none';
        document.getElementById('seat-selection').style.display = 'none';
        document.getElementById('safari-details').style.display = 'none';
        document.getElementById('passenger-form').style.display = 'none';
        document.getElementById('ticket-display').style.display = 'none';
        
        // Hide booking form and recommended trips when showing search results
        document.querySelector('.booking-form').style.display = 'none';
        document.querySelector('.recommended-trips').style.display = 'none';
        
        window.selectedCompany = null;
        window.selectedFlight = null;
        window.selectedPrice = null;
        window.selectedSeat = null;
    }

    // Function to validate search form
    function validateSearchForm(from, to, date) {
        let isValid = true;
        
        // Reset previous errors
        document.querySelectorAll('.form-group').forEach(group => {
            group.classList.remove('error');
        });
        
        if (!from) {
            document.querySelector('#from-dropdown').closest('.form-group').classList.add('error');
            isValid = false;
        } else {
            document.querySelector('#from-dropdown').closest('.form-group').classList.remove('error');
        }
        
        if (!to) {
            document.querySelector('#to-dropdown').closest('.form-group').classList.add('error');
            isValid = false;
        } else {
            document.querySelector('#to-dropdown').closest('.form-group').classList.remove('error');
        }
        
        if (!date) {
            document.querySelector('#departure').closest('.form-group').classList.add('error');
            isValid = false;
        } else {
            document.querySelector('#departure').closest('.form-group').classList.remove('error');
        }
        
        if (from && to && from === to) {
            showNotification(translations[currentLanguage].differentCities, 'error');
            isValid = false;
        }
        
        if (!isValid) {
            showNotification(translations[currentLanguage].fillRequired, 'error');
        }
        
        return isValid;
    }

    // Hakikisha miji tofauti imechaguliwa
    function validateCitySelection() {
        const fromValue = document.querySelector('#from-dropdown .dropdown-input').getAttribute('data-value');
        const toValue = document.querySelector('#to-dropdown .dropdown-input').getAttribute('data-value');
        
        if (fromValue && toValue && fromValue === toValue) {
            showNotification(translations[currentLanguage].differentCities, 'error');
            return false;
        }
        
        return true;
    }

    // Function to show notification
    function showNotification(message, type = 'info') {
        const notificationArea = document.getElementById('notification-area');
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        notification.innerHTML = `
            <div class="notification-content">
                <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : type === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle'}"></i>
                <span>${message}</span>
            </div>
        `;
        
        notificationArea.appendChild(notification);
        
        // Show notification
        setTimeout(() => {
            notification.classList.add('show');
        }, 10);
        
        // Hide notification after 5 seconds
        setTimeout(() => {
            notification.classList.remove('show');
            setTimeout(() => {
                notification.remove();
            }, 300);
        }, 5000);
    }

    // Function to show/hide loading overlay
    function showLoading(show) {
        const loadingOverlay = document.getElementById('loading-overlay');
        if (show) {
            loadingOverlay.classList.add('active');
        } else {
            loadingOverlay.classList.remove('active');
        }
    }

    // Function to calculate distance between two cities (simplified)
    function calculateDistance(from, to) {
        const city1 = cities[from];
        const city2 = cities[to];
        
        if (!city1 || !city2) return 0;
        
        // Calculate distance using Haversine formula (simplified)
        const R = 6371; // Earth's radius in km
        const dLat = (city2.lat - city1.lat) * Math.PI / 180;
        const dLon = (city2.lng - city1.lng) * Math.PI / 180;
        const a = 
            Math.sin(dLat/2) * Math.sin(dLat/2) +
            Math.cos(city1.lat * Math.PI / 180) * Math.cos(city2.lat * Math.PI / 180) * 
            Math.sin(dLon/2) * Math.sin(dLon/2);
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
        const distance = R * c;
        
        return Math.round(distance);
    }

    // Function to calculate travel duration based on transport type
    function calculateDuration(distance, transportType) {
        let averageSpeed, additionalTime;
        
        switch(transportType) {
            case "flight":
                averageSpeed = 800;
                additionalTime = 0.30;
                break;
            case "train":
                averageSpeed = 80;
                additionalTime = 0.25;
                break;
            case "bus":
                averageSpeed = 65;
                additionalTime = 0.33;
                break;
            default:
                averageSpeed = 60;
                additionalTime = 0;
        }
        
        const baseDuration = distance / averageSpeed;
        const totalHours = baseDuration + additionalTime;
        const hours = Math.floor(totalHours);
        const minutes = Math.round((totalHours - hours) * 60);
        
        return { 
            hours, 
            minutes, 
            totalHours
        };
    }

    // Function to calculate arrival date and time
    function calculateArrivalInfo(departureDate, departureTime, durationHours, durationMinutes) {
        const departureDateTime = new Date(`${departureDate}T${departureTime}`);
        
        departureDateTime.setHours(departureDateTime.getHours() + durationHours);
        departureDateTime.setMinutes(departureDateTime.getMinutes() + durationMinutes);
        
        const arrivalDate = departureDateTime.toISOString().split('T')[0];
        const arrivalHours = departureDateTime.getHours().toString().padStart(2, '0');
        const arrivalMinutes = departureDateTime.getMinutes().toString().padStart(2, '0');
        const arrivalTime = `${arrivalHours}:${arrivalMinutes}`;
        
        return {
            date: arrivalDate,
            time: arrivalTime,
            datetime: departureDateTime
        };
    }

    // Function to generate a random time with realistic departure times for each transport
    function generateRandomTime(transportType) {
        let minHour, maxHour;
        
        switch(transportType) {
            case "flight":
                minHour = 6;
                maxHour = 23;
                break;
            case "train":
                minHour = 5;
                maxHour = 23;
                break;
            case "bus":
                minHour = 4;
                maxHour = 23;
                break;
            default:
                minHour = 6;
                maxHour = 18;
        }
        
        const hours = Math.floor(Math.random() * (maxHour - minHour + 1)) + minHour;
        const minutes = Math.floor(Math.random() * 60);
        
        return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
    }

    // Function to format currency
    function formatCurrency(amount) {
        return `TZS ${amount.toLocaleString()}`;
    }

    // Function to generate consistent price
    function generatePrice(distance, transportType, companyId, stopovers = []) {
        const pricePerKm = PRICE_PER_KM[transportType][companyId];
        
        if (!pricePerKm) {
            switch(transportType) {
                case "flight": return distance * 350;
                case "train": return distance * 115;
                case "bus": return distance * 77;
                default: return distance * 100;
            }
        }
        
        let price = distance * pricePerKm;
        
        const minPrice = BASE_PRICES[transportType] || 10000;
        if (price < minPrice) {
            price = minPrice;
        }
        
        switch(companyId) {
            case "KQ":
                price *= 1.15;
                break;
            case "PW":
                price *= 1.05;
                break;
            case "AT":
                price *= 0.95;
                break;
            case "FA":
                price *= 1.10;
                break;
            case "AZ":
                price *= 0.90;
                break;
            case "SC":
                price *= 1.20;
                break;
            case "KM":
                price *= 1.00;
                break;
            case "AA":
                price *= 0.90;
                break;
        }
        
        if (stopovers && stopovers.length > 0) {
            const stopoverSurcharge = transportType === "flight" ? 0.15 : 0.10;
            price = price * (1 + (stopovers.length * stopoverSurcharge));
        }
        
        return Math.round(price);
    }

    // Function to check if a departure time is valid (at least 30 minutes from now)
    function isValidDepartureTime(departureDate, departureTime) {
        const now = new Date();
        const today = now.toISOString().split('T')[0];
        
        if (departureDate !== today) {
            return true;
        }
        
        const departureDateTime = new Date(`${departureDate}T${departureTime}`);
        const timeDifference = departureDateTime - now;
        const minutesDifference = timeDifference / (1000 * 60);
        
        return minutesDifference >= 30;
    }

    // Function mpya: Pata safari zilizopo kwa kampuni na ruti
     function getAvailableFlights(company, from, to) {
        if (company.flights) {
            return company.flights.filter(flight => {
                const routeParts = flight.route.split('-');
                const flightFrom = routeParts[0];
                const flightTo = routeParts[1];
                
                if (flightFrom === from && flightTo === to) {
                    return true;
                }
                
                if (flight.stops && flight.stops.length > 0) {
                    const allStops = [flightFrom, ...flight.stops, flightTo];
                    const fromIndex = allStops.indexOf(from);
                    const toIndex = allStops.indexOf(to);
                    
                    if (fromIndex !== -1 && toIndex !== -1 && fromIndex < toIndex) {
                        return true;
                    }
                }
                
                return false;
            });
        }
        return [];
    }

    // Function mpya: Pata ratiba za treni/basi
        function getAvailableSchedules(company, from, to) {
        if (company.schedules) {
            return company.schedules.filter(schedule => {
                const routeParts = schedule.route.split('-');
                const scheduleFrom = routeParts[0];
                const scheduleTo = routeParts[1];
                
                if (scheduleFrom === from && scheduleTo === to) {
                    return true;
                }
                
                if (schedule.stops && schedule.stops.length > 0) {
                    const allStops = [scheduleFrom, ...schedule.stops, scheduleTo];
                    const fromIndex = allStops.indexOf(from);
                    const toIndex = allStops.indexOf(to);
                    
                    if (fromIndex !== -1 && toIndex !== -1 && fromIndex < toIndex) {
                        return true;
                    }
                }
                
                return false;
            });
        }
        return [];
    }

    // Function to show available options
   function showAvailableOptions(from, to, date, passengers) {
        const transportOptions = document.getElementById('transport-options');
        transportOptions.innerHTML = '';
        
        const transportType = document.querySelector('.transport-btn.active').dataset.type;
        const t = translations[currentLanguage];
        
        let companies;
        switch(transportType) {
            case "flight":
                companies = flightCompanies;
                break;
            case "train":
                companies = trainCompanies;
                break;
            case "bus":
                companies = busCompanies;
                break;
            default:
                companies = [];
        }
        
        const distance = calculateDistance(from, to);
        const cityNames = {
            "DAR": "Dar es Salaam", "JRO": "Kilimanjaro", "ZNZ": "Zanzibar", "MWZ": "Mwanza",
            "ARK": "Arusha", "TGT": "Tanga", "DOD": "Dodoma", "MBY": "Mbeya",
            "MTW": "Mtwara", "KIG": "Kigoma", "TAB": "Tabora", "SON": "Songea",
            "BKZ": "Bukoba", "NBO": "Nairobi", "KBH": "Kahama", "IRG": "Iringa"
        };
        
        // Update price comparison with consistent pricing
        const flightPrice = generatePrice(distance, "flight", "PW");
        const trainPrice = generatePrice(distance, "train", "TRC");
        const busPrice = generatePrice(distance, "bus", "KM");
        
        document.getElementById('flight-price').textContent = formatCurrency(flightPrice);
        document.getElementById('train-price').textContent = formatCurrency(trainPrice);
        document.getElementById('bus-price').textContent = formatCurrency(busPrice);
        
        // Update price comparison title and labels
        document.querySelector('.price-comparison-title').textContent = t.priceComparison;
        document.querySelectorAll('.price-comparison-item h3').forEach((h3, index) => {
            const types = [t.flight, t.train, t.bus];
            if (index < types.length) {
                h3.textContent = types[index];
            }
        });
        document.querySelectorAll('.price-comparison-item p').forEach((p, index) => {
            const texts = [`${t.perKm} TZS `, `${t.perKm} TZS `, `${t.perKm} TZS `];
            if (index < texts.length) {
                p.textContent = texts[index];
            }
        });
        
        document.getElementById('price-comparison').style.display = 'block';
        
        // Filter companies that serve this route
        const availableCompanies = companies.filter(company => {
            const servesFrom = company.routes.includes(from);
            const servesTo = company.routes.includes(to);
            
            if (!servesFrom || !servesTo) return false;
            
            let availableOptions = [];
            if (transportType === "flight") {
                availableOptions = getAvailableFlights(company, from, to);
            } else if (transportType === "train" || transportType === "bus") {
                availableOptions = getAvailableSchedules(company, from, to);
            }
            
            return availableOptions.length > 0;
        });
        
        if (availableCompanies.length === 0) {
            transportOptions.innerHTML = `
                <div class="no-results"><center>
                    <h3 style="color:red">${t.noTransportFound.replace('__type__', transportType === 'flight' ? t.flight : transportType === 'train' ? t.train : t.bus)}</h3>
                    <p style="color:red">${t.tryDifferent}</p></center>
                </div>
            `;
            document.getElementById('results-section').style.display = 'block';
            return;
        }
        
        // Generate options for each company
        let hasValidOptions = false;
        
        availableCompanies.forEach(company => {
            let availableOptions = [];
            
            if (transportType === "flight") {
                availableOptions = getAvailableFlights(company, from, to);
            } else if (transportType === "train" || transportType === "bus") {
                availableOptions = getAvailableSchedules(company, from, to);
            }
            
            availableOptions.forEach(option => {
                const departureTime = option.departureTime;
                
                if (!isValidDepartureTime(date, departureTime)) {
                    return;
                }
                
                hasValidOptions = true;
                
                let duration = calculateDuration(distance, transportType);
                
                if (option.stops && option.stops.length > 0) {
                    const stopoverTime = option.stops.length * 0.5;
                    duration.totalHours += stopoverTime;
                    duration.hours = Math.floor(duration.totalHours);
                    duration.minutes = Math.round((duration.totalHours - duration.hours) * 60);
                }
                
                const arrivalInfo = calculateArrivalInfo(date, departureTime, duration.hours, duration.minutes);
                
                const price = generatePrice(distance, transportType, company.id, option.stops);
                const formattedPrice = formatCurrency(price);
                
                // Use translated flight type badges
                const flightTypeBadge = option.isDirect ? 
                    `<span style="background:#10ac84; color:white; padding:2px 6px; border-radius:10px; font-size:10px;">${t.directFlight}</span>` : 
                    `<span style="background:#ff9f43; color:white; padding:2px 6px; border-radius:10px; font-size:10px;">${t.stopoverFlight}</span>`;
                
                let stopoverInfo = '';
                let stopoverDot = '';
                if (option.stops && option.stops.length > 0) {
                    const stopoverCities = option.stops.map(stop => cityNames[stop]).join(', ');
                    stopoverInfo = `
                        <div class="stopover-details">
                            <i class="fas fa-plane-stop"></i> ${t.stopover}: ${stopoverCities} (30m)
                        </div>
                    `;
                    stopoverDot = `<div class="stopover-dot"></div>`;
                }
                
                const showDifferentDate = arrivalInfo.date !== date;
                
                transportOptions.innerHTML += `
                    <div class="transport-option-card" data-company="${company.id}" data-flight="${option.code}" data-price="${price}" data-from="${from}" data-to="${to}" data-date="${date}" data-passengers="${passengers}">
                        <div class="option-header">
                            <div class="company-info">
                                <div class="company-logo ${transportType}-logo">
                                    ${company.logo ? 
                                        `<img src="${company.logo}" alt="${company.name}" class="company-logo-img">` : 
                                        `<div class="company-logo-text">${company.name}</div>`
                                    }
                                </div>
                                <div class="company-name">${company.name}</div>
                                ${flightTypeBadge}
                            </div>
                            <div class="option-number">${option.code}</div>
                        </div>
                        <div class="option-body">
                            <div class="option-departure">
                                <div class="option-city">${cityNames[from]}</div>
                                <div class="option-time">${departureTime}</div>
                                <div class="option-date">${date}</div>
                            </div>
                            <div class="option-duration">
                                <div class="duration-time">${duration.hours}h ${duration.minutes}m</div>
                                <div class="duration-line">${stopoverDot}</div>
                                <div class="duration-distance">${distance} km</div>
                                ${stopoverInfo}
                            </div>
                            <div class="option-arrival">
                                <div class="option-city">${cityNames[to]}</div>
                                <div class="option-time">${arrivalInfo.time}</div>
                                <div class="option-date">${arrivalInfo.date} ${showDifferentDate ? `<span style="color:#ff9f43">${t.nextDay}</span>` : ''}</div>
                            </div>
                        </div>
                        <div class="option-footer">
                            <div>
                                <div class="option-price">${formattedPrice}</div>
                                <div class="price-details">${t.passengersCount.replace('__count__', passengers)}</div>
                                ${option.stops && option.stops.length > 0 ? 
                                    `<div class="price-details" style="color:#ff9f43">+${t.stopovers.replace('__count__', option.stops.length)}</div>` : ''}
                            </div>
                            <button class="select-btn" data-company="${company.id}" data-flight="${option.code}">${t.select}</button>
                        </div>
                    </div>
                `;
            });
        });
        
        // Show appropriate message if no valid options found
        if (!hasValidOptions) {
            const now = new Date();
            const today = now.toISOString().split('T')[0];
            const currentTime = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
            
            if (date === today) {
                transportOptions.innerHTML = `
                    <div class="no-results"><center>
                        <h3 style="color:red">${t.noTripsToday.replace('__type__', transportType === 'flight' ? t.flight : transportType === 'train' ? t.train : t.bus)}</h3>
                        <p style="color:red">${t.noTripsAfter.replace('__time__', currentTime)}</p>
                        <p style="color:blue">${t.tryDifferentDate}</p></center>
                    </div>
                `;
            } else {
                transportOptions.innerHTML = `
                    <div class="no-results"><center>
                        <h3 style="color:red">${t.noTransportFound.replace('__type__', transportType === 'flight' ? t.flight : transportType === 'train' ? t.train : t.bus)}</h3>
                        <p style="color:red">${t.tryDifferent}</p></center>
                    </div>
                `;
            }
        }
        
        // Update results title
        document.querySelector('.results-title').innerHTML = `<i class="fas fa-search"></i> <span>${t.searchResults}</span>`;
        document.getElementById('results-section').style.display = 'block';
        
        // Scroll to results
        document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });
        
        // Add event listeners to select buttons
        document.querySelectorAll('.select-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const companyId = this.dataset.company;
                const flightCode = this.dataset.flight;
                const card = this.closest('.transport-option-card');
                selectOption(card, companyId, flightCode);
            });
        });
    }

    // Function to handle option selection
    function selectOption(card, companyId, flightCode) {
        const from = card.dataset.from;
        const to = card.dataset.to;
        const date = card.dataset.date;
        const passengers = card.dataset.passengers;
        const price = card.dataset.price;
        
        const transportType = document.querySelector('.transport-btn.active').dataset.type;
        const t = translations[currentLanguage];
        
        let company;
        switch(transportType) {
            case "flight":
                company = flightCompanies.find(c => c.id === companyId);
                break;
            case "train":
                company = trainCompanies.find(c => c.id === companyId);
                break;
            case "bus":
                company = busCompanies.find(c => c.id === companyId);
                break;
            default:
                company = null;
        }
        
        if (!company) return;

        let selectedFlightOption = null;
        if (transportType === "flight") {
            selectedFlightOption = company.flights.find(f => f.code === flightCode);
        } else if (transportType === "train" || transportType === "bus") {
            selectedFlightOption = company.schedules.find(s => s.code === flightCode);
        }
        
        window.selectedCompany = company;
        window.selectedFlight = selectedFlightOption;
        window.selectedPrice = price;

        document.getElementById('results-section').style.display = 'none';
        document.getElementById('price-comparison').style.display = 'none';
        
        const selectedOption = document.getElementById('selected-option');
        const selectedOptionDetails = document.getElementById('selected-option-details');
        
        // Update selected option header
        document.querySelector('.selected-header').textContent = t.selectedTrip;
        
        selectedOptionDetails.innerHTML = `
            <div class="transport-option-card">
                <div class="option-header">
                    <div class="company-info">
                        <div class="company-logo ${transportType}-logo">
                            ${company.logo ? 
                                `<img src="${company.logo}" alt="${company.name}" class="company-logo-img">` : 
                                `<div class="company-logo-text">${company.name}</div>`
                            }
                        </div>
                        <div class="company-name">${company.name}</div>
                        ${selectedFlightOption.isDirect ? 
                            `<span style="background:#10ac84; color:white; padding:2px 6px; border-radius:10px; font-size:10px;">${t.directFlight}</span>` : 
                            `<span style="background:#ff9f43; color:white; padding:2px 6px; border-radius:10px; font-size:10px;">${t.stopoverFlight}</span>`
                        }
                    </div>
                </div>
                <div class="option-body">
                    <div class="option-departure">
                        <div class="option-city">${cities[from].name}</div>
                        <div class="option-time">${card.querySelector('.option-departure .option-time').textContent}</div>
                        <div class="option-date">${date}</div>
                    </div>
                    <div class="option-duration">
                        <div class="duration-time">${card.querySelector('.option-duration .duration-time').textContent}</div>
                        <div class="duration-line">${card.querySelector('.option-duration .duration-line').innerHTML}</div>
                        <div class="duration-distance">${card.querySelector('.option-duration .duration-distance').textContent}</div>
                        ${card.querySelector('.stopover-details') ? card.querySelector('.stopover-details').outerHTML : ''}
                    </div>
                    <div class="option-arrival">
                        <div class="option-city">${cities[to].name}</div>
                        <div class="option-time">${card.querySelector('.option-arrival .option-time').textContent}</div>
                        <div class="option-date">${card.querySelector('.option-arrival .option-date').innerHTML}</div>
                    </div>
                </div>
                <div class="option-footer">
                    <div>
                        <div class="option-price">${formatCurrency(parseInt(price))}</div>
                        <div class="price-details">${t.passengersCount.replace('__count__', passengers)}</div>
                        ${selectedFlightOption.stops && selectedFlightOption.stops.length > 0 ? 
                            `<div class="price-details" style="color:#ff9f43">+${t.stopovers.replace('__count__', selectedFlightOption.stops.length)}</div>` : ''}
                    </div>
                </div>
            </div>
        `;
        
        selectedOption.style.display = 'block';
        selectedOption.scrollIntoView({ behavior: 'smooth' });
        
        // Show safari details instead of passenger form directly
        if (transportType === 'flight' || transportType === 'train') {
            setTimeout(() => {
                selectedOption.style.display = 'none';
                showSafariDetails(transportType, company, from, to, date, passengers, price);
            }, 1500);
        } else {
            setTimeout(() => {
                selectedOption.style.display = 'none';
                showSeatSelection(transportType, company, from, to, date, passengers, price);
            }, 1500);
        }
    }

    // Function to show seat selection (for bus only)
    function showSeatSelection(transportType, company, from, to, date, passengers, price) {
        const seatSelection = document.getElementById('seat-selection');
        const transportLayout = document.getElementById('transport-layout');
        const t = translations[currentLanguage];
        
        // Update seat selection title and labels
        document.querySelector('.seat-selection-title').textContent = t.chooseSeat;
        document.getElementById('confirm-seat-btn').innerHTML = t.confirmSeat;
        
        let layoutHTML = generateBusSeats();
        transportLayout.innerHTML = layoutHTML;
        
        document.querySelectorAll('.seat').forEach(seat => {
            if (!seat.classList.contains('occupied')) {
                seat.addEventListener('click', function() {
                    if (this.classList.contains('selected')) {
                        this.classList.remove('selected');
                        document.getElementById('selected-seat-info').style.display = 'none';
                        window.selectedSeat = null;
                    } else {
                        document.querySelectorAll('.seat.selected').forEach(s => {
                            s.classList.remove('selected');
                        });
                        this.classList.add('selected');
                        
                        const seatInfo = document.getElementById('selected-seat-info');
                        seatInfo.innerHTML = `${t.selectedSeat} <strong>${this.textContent}</strong>`;
                        seatInfo.style.display = 'block';
                        window.selectedSeat = this.textContent;
                    }
                    
                    document.getElementById('confirm-seat-btn').disabled = 
                        document.querySelectorAll('.seat.selected').length === 0;
                });
            }
        });
        
        seatSelection.style.display = 'block';
        seatSelection.scrollIntoView({ behavior: 'smooth' });
        
        // Update event listener to show safari details after seat selection
        const confirmBtn = document.getElementById('confirm-seat-btn');
        confirmBtn.onclick = function() {
            const selectedSeat = document.querySelector('.seat.selected');
            if (selectedSeat) {
                seatSelection.style.display = 'none';
                showSafariDetails(transportType, company, from, to, date, passengers, price, selectedSeat.textContent);
            }
        };
    }

    // Function to generate bus seats
    function generateBusSeats() {
        const t = translations[currentLanguage];
        
        let html = `
            <div class="bus-layout-container">
                <div class="bus-header">
                    <h3>${t.chooseSeat}</h3>
                    <p>${t.clickToSelectSeat}</p>
                </div>
                
                <div class="bus-steering">
                    <i class="fas fa-steering-wheel"></i> ${t.driverSection}
                </div>
                
                <div class="selected-seat-info" id="selected-seat-info"></div>
                
                <div class="bus-seats-grid">
        `;
        
        const rows = 10;
        const seatsPerRow = 4;
        const seatLetters = ['A', 'B', 'C', 'D'];
        
        for (let row = 1; row <= rows; row++) {
            for (let seat = 0; seat < seatsPerRow; seat++) {
                if (seat === 2) {
                    html += `<div class="bus-aisle">${t.aisle}</div>`;
                }
                
                const seatNumber = `${row}${seatLetters[seat]}`;
                const isOccupied = Math.random() < 0.3;
                const isEmergency = (row === 1 && (seat === 0 || seat === 3));
                
                let seatClass = 'available';
                if (isOccupied) seatClass = 'occupied';
                if (isEmergency) seatClass = 'emergency';
                
                html += `<div class="bus-seat seat ${seatClass}">${seatNumber}</div>`;
            }
        }
        
        html += `</div></div>`;
        
        return html;
    }

    // Function to show safari details
    function showSafariDetails(transportType, company, from, to, date, passengers, price, seat = null) {
        const safariDetails = document.getElementById('safari-details');
        const detailsContent = document.getElementById('safari-details-content');
        const t = translations[currentLanguage];
        
        // Get vehicle details based on route
        const vehicleDetails = getVehicleDetails(transportType, company.id, from, to);
        
        // Calculate trip details
        const distance = calculateDistance(from, to);
        const duration = calculateDuration(distance, transportType);
        const departureTime = window.selectedFlight ? window.selectedFlight.departureTime : generateRandomTime(transportType);
        const arrivalInfo = calculateArrivalInfo(date, departureTime, duration.hours, duration.minutes);
        
        // Get stopover information
        let stopoverInfo = currentLanguage === 'sw' ? 'Hakuna stopover' : 'No stopover';
        let stopoverTime = '0 dakika';
        
        if (window.selectedFlight && window.selectedFlight.stops && window.selectedFlight.stops.length > 0) {
            const stopCount = window.selectedFlight.stops.length;
            const stopTimePer = transportType === 'flight' ? 30 : 20; // minutes per stop
            const totalStopTime = stopCount * stopTimePer;
            
            stopoverInfo = currentLanguage === 'sw' 
                ? `${stopCount} stopover(s): ${window.selectedFlight.stops.map(s => cities[s].name).join(', ')}`
                : `${stopCount} stopover(s): ${window.selectedFlight.stops.map(s => cities[s].name).join(', ')}`;
            
            stopoverTime = `${totalStopTime} ${currentLanguage === 'sw' ? 'dakika' : 'minutes'}`;
        }
        
        const totalHours = duration.totalHours + (window.selectedFlight && window.selectedFlight.stops ? window.selectedFlight.stops.length * 0.5 : 0);
        const totalHoursFormatted = Math.floor(totalHours);
        const totalMinutes = Math.round((totalHours - totalHoursFormatted) * 60);
        
        // Prepare details HTML
        detailsContent.innerHTML = `
            <div class="detail-card">
                <h4><i class="fas fa-info-circle"></i> ${t.travelInfo}</h4>
                <div class="info-item">
                    <span class="info-label">${t.from}:</span>
                    <span class="info-value">${cities[from].name}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">${t.to}:</span>
                    <span class="info-value">${cities[to].name}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">${t.departureDate}:</span>
                    <span class="info-value">${date}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">${t.departureTime}:</span>
                    <span class="info-value">${departureTime}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">${t.arrivalTime}:</span>
                    <span class="info-value">${arrivalInfo.time}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">${t.travelTime}:</span>
                    <span class="info-value">${totalHoursFormatted}h ${totalMinutes}m</span>
                </div>
                ${window.selectedFlight && window.selectedFlight.stops && window.selectedFlight.stops.length > 0 ? `
                <div class="info-item">
                    <span class="info-label">${t.stopover}:</span>
                    <span class="info-value">${stopoverInfo}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">${t.stopoverTime}:</span>
                    <span class="info-value">${stopoverTime}</span>
                </div>
                ` : ''}
            </div>
            
            <div class="detail-card">
                <h4><i class="fas fa-cog"></i> ${t.vehicleDetails}</h4>
                <div class="info-item">
                    <span class="info-label">${t.company}:</span>
                    <span class="info-value">${company.name}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">${t.tripNumber}:</span>
                    <span class="info-value">${window.selectedFlight ? window.selectedFlight.code : 'N/A'}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">${t.vehicleType}</span>
                    <span class="info-value">${vehicleDetails.planeType || vehicleDetails.busType || vehicleDetails.trainType || 'Hakuna taarifa'}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">${t.tripType}:</span>
                    <span class="info-value">${window.selectedFlight && !window.selectedFlight.isDirect ? t.stopoverFlight : t.directFlight}</span>
                </div>
            </div>
            
            <div class="detail-card">
                <h4><i class="fas fa-suitcase"></i> ${t.luggageServices}</h4>
                <div class="info-item">
                    <span class="info-label">${t.allowedLuggage}:</span>
                    <span class="info-value">${vehicleDetails.luggage || 'Hakuna taarifa'}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">${t.includedServices}:</span>
                    <span class="info-value">${vehicleDetails.services || 'Hakuna taarifa'}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">${t.availableAmenities}:</span>
                    <span class="info-value">${vehicleDetails.amenities || 'Hakuna taarifa'}</span>
                </div>
                ${seat ? `
                <div class="info-item">
                    <span class="info-label">${t.seat}:</span>
                    <span class="info-value">${seat}</span>
                </div>
                ` : ''}
                <div class="info-item">
                    <span class="info-label">${t.passenger}:</span>
                    <span class="info-value">${passengers}</span>
                </div>
            </div>
            
            <div class="detail-card">
                <h4><i class="fas fa-money-bill-wave"></i> ${t.paymentDetails}</h4>
                <div class="info-item">
                    <span class="info-label">${t.farePerPerson}:</span>
                    <span class="info-value">${formatCurrency(parseInt(price))}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">${currentLanguage === 'sw' ? 'Idadi ya Abiria:' : 'Total Passengers:'}</span>
                    <span class="info-value">${passengers}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">${t.totalPayment}:</span>
                    <span class="info-value" style="color: #10ac84; font-size: 1.2rem;">${formatCurrency(parseInt(price) * parseInt(passengers))}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">${currentLanguage === 'sw' ? 'Umbali:' : 'Distance:'}</span>
                    <span class="info-value">${distance} km</span>
                </div>
                <div class="info-item">
                    <span class="info-label">${t.notes}:</span>
                    <span class="info-value">${t.finalPriceNote}</span>
                </div>
            </div>
        `;
        
        // Update terms text based on language
        document.querySelectorAll('.terms-text')[0].textContent = t.termsText;
        document.querySelectorAll('.terms-text')[1].textContent = t.luggageTerms;
        
        // Update continue button text
        document.getElementById('continue-btn').innerHTML = t.continueToPassenger;
        
        // Show the section
        safariDetails.style.display = 'block';
        
        // Scroll to safari details
        safariDetails.scrollIntoView({ behavior: 'smooth' });
        
        // Add event listeners to checkboxes
        const agreeTerms = document.getElementById('agree-terms');
        const agreeLuggage = document.getElementById('agree-luggage');
        const continueBtn = document.getElementById('continue-btn');
        
        function updateContinueButton() {
            continueBtn.disabled = !(agreeTerms.checked && agreeLuggage.checked);
        }
        
        agreeTerms.addEventListener('change', updateContinueButton);
        agreeLuggage.addEventListener('change', updateContinueButton);
        
        // Add event listener to continue button
        continueBtn.onclick = function() {
            if (agreeTerms.checked && agreeLuggage.checked) {
                safariDetails.style.display = 'none';
                showPassengerForm(transportType, company, from, to, date, passengers, price, seat);
            }
        };
    }

    // Function to show passenger form
    function showPassengerForm(transportType, company, from, to, date, passengers, price, seat = null) {
        const passengerForm = document.getElementById('passenger-form');
        const passengerDetails = document.getElementById('passenger-details');
        const t = translations[currentLanguage];
        
        // Update passenger form title
        document.querySelector('.passenger-form-title').textContent = t.passengerInfo;
        document.querySelector('.shared-details h3').textContent = t.contactDetails;
        document.getElementById('book-ticket-btn').innerHTML = `<i class="fas fa-ticket-alt"></i> ${t.payGetTicket}`;
        
        let formHTML = '';
        const passengerCount = parseInt(passengers);
        
        if (seat) {
            formHTML += `
                <div class="passenger-form-group">
                    <h3>${t.seatInfo}</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="seat-number">${t.seatNumber}</label>
                            <input type="text" id="seat-number" value="${seat}" readonly>
                        </div>
                    </div>
                </div>
            `;
        }
        
        for (let i = 1; i <= passengerCount; i++) {
            formHTML += `
                <div class="passenger-form-group">
                    <h3>${t.passenger} ${i}</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="passenger-${i}-name">${t.fullName}</label>
                            <input type="text" id="passenger-${i}-name" placeholder="${t.firstNamePlaceholder}" required>
                            <div class="error-message">${t.fieldRequired}</div>
                        </div>
                        <div class="form-group">
                            <label for="passenger-${i}-id">${t.idNumber}</label>
                            <input type="text" id="passenger-${i}-id" placeholder="${t.idPlaceholder}">
                            <div class="optional-field">${t.optional}</div>
                        </div>
                        <div class="form-group">
                            <label for="passenger-${i}-age">${t.age}</label>
                            <input type="number" id="passenger-${i}-age" placeholder="${t.agePlaceholder}" min="1" max="120" required>
                            <div class="error-message">${t.fieldRequired}</div>
                        </div>
                        <div class="form-group">
                            <label for="passenger-${i}-gender">${t.gender}</label>
                            <select id="passenger-${i}-gender" required>
                                <option value="">${t.chooseGender}</option>
                                <option value="male">${t.male}</option>
                                <option value="female">${t.female}</option>
                            </select>
                            <div class="error-message">${t.fieldRequired}</div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        passengerDetails.innerHTML = formHTML;
        
        // Update contact form labels
        document.querySelector('label[for="contact-email"]').textContent = t.email;
        document.querySelector('label[for="contact-phone"]').textContent = t.phone;
        document.querySelector('label[for="id-number"]').textContent = t.idNumber;
        document.querySelector('.optional-field').textContent = t.optional;
        
        // Update placeholders
        document.getElementById('contact-email').placeholder = currentLanguage === 'sw' ? 'mwananchi@example.com' : 'citizen@example.com';
        document.getElementById('contact-phone').placeholder = currentLanguage === 'sw' ? '+255 123 456 789' : '+255 123 456 789';
        document.getElementById('id-number').placeholder = currentLanguage === 'sw' ? 'Nambari ya kitambulisho (siyo lazima)' : 'ID number (optional)';
        
        passengerForm.style.display = 'block';
        passengerForm.scrollIntoView({ behavior: 'smooth' });
    }

    // Function to validate passenger form
    function validatePassengerForm(passengerCount) {
        let isValid = true;
        
        document.querySelectorAll('.passenger-form-group .form-group').forEach(group => {
            group.classList.remove('error');
        });
        
        for (let i = 1; i <= passengerCount; i++) {
            const name = document.getElementById(`passenger-${i}-name`);
            const age = document.getElementById(`passenger-${i}-age`);
            const gender = document.getElementById(`passenger-${i}-gender`);
            
            if (!name || !name.value.trim()) {
                if (name) name.closest('.form-group').classList.add('error');
                isValid = false;
            }
            if (!age || !age.value) {
                if (age) age.closest('.form-group').classList.add('error');
                isValid = false;
            }
            if (!gender || !gender.value) {
                if (gender) gender.closest('.form-group').classList.add('error');
                isValid = false;
            }
        }
        
        const email = document.getElementById('contact-email');
        const phone = document.getElementById('contact-phone');
        
        if (!email || !email.value.trim()) {
            if (email) email.closest('.form-group').classList.add('error');
            isValid = false;
        }
        
        if (!phone || !phone.value.trim()) {
            if (phone) phone.closest('.form-group').classList.add('error');
            isValid = false;
        }
        
        return isValid;
    }

    // Function to generate custom barcode with wide and narrow lines
    function generateCustomBarcode(bookingRef) {
        const pattern = [];
        for (let i = 0; i < bookingRef.length; i++) {
            const charCode = bookingRef.charCodeAt(i);
            
            if (charCode % 3 === 0) {
                pattern.push('wide', 'narrow', 'wide', 'narrow');
            } else if (charCode % 3 === 1) {
                pattern.push('narrow', 'wide', 'narrow', 'wide');
            } else {
                pattern.push('wide', 'wide', 'narrow', 'narrow');
            }
        }
        
        let barcodeHTML = '<div class="barcode-lines">';
        pattern.forEach(type => {
            barcodeHTML += `<div class="barcode-line ${type}"></div>`;
        });
        barcodeHTML += '</div>';
        
        return barcodeHTML;
    }

    // Function maalum kwa uchapishaji
    function printTicket() {
        const originalDisplay = document.getElementById('ticket-display').style.display;
        
        document.getElementById('ticket-display').style.display = 'block';
        
        setTimeout(() => {
            window.print();
            
            setTimeout(() => {
                document.getElementById('ticket-display').style.display = originalDisplay;
            }, 1000);
        }, 500);
    }

    // Function to generate ticket
    function generateTicket(transportType, company, from, to, date, passengers, price, seat) {
        const ticketDisplay = document.getElementById('ticket-display');
        const passengerCount = parseInt(passengers);
        const t = translations[currentLanguage];
        
        let passengerListHTML = '';
        for (let i = 1; i <= passengerCount; i++) {
            const name = document.getElementById(`passenger-${i}-name`).value;
            const id = document.getElementById(`passenger-${i}-id`).value;
            const age = document.getElementById(`passenger-${i}-age`).value;
            const gender = document.getElementById(`passenger-${i}-gender`).value;
            
            passengerListHTML += `
                <div class="passenger-item">
                    <strong>${t.passenger} ${i}:</strong> ${name} (${gender === 'male' ? t.male.charAt(0) : t.female.charAt(0)}, ${age} ${t.years}) ${id ? '- ' + (currentLanguage === 'sw' ? 'Namba: ' : 'ID: ') + id : ''}
                </div>
            `;
        }
        
        const email = document.getElementById('contact-email').value;
        const phone = document.getElementById('contact-phone').value;
        
        const bookingRef = `BKG${Math.floor(100000 + Math.random() * 900000)}`;
        
        const departureTime = window.selectedFlight ? window.selectedFlight.departureTime : generateRandomTime(transportType);
        
        const distance = calculateDistance(from, to);
        const duration = calculateDuration(distance, transportType);
        const arrivalInfo = calculateArrivalInfo(date, departureTime, duration.hours, duration.minutes);
        
        const customBarcode = generateCustomBarcode(bookingRef);
        
        const flightTypeText = window.selectedFlight ? (window.selectedFlight.isDirect ? t.directFlight : t.stopoverFlight) : (currentLanguage === 'sw' ? 'Safari ya Kawaida' : 'Standard Trip');
        
        const showDifferentDate = arrivalInfo.date !== date;
        
        const today = new Date().toLocaleDateString(currentLanguage === 'sw' ? 'sw-TZ' : 'en-US', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });
        
        const transportTypeText = transportType === 'flight' ? t.flight : transportType === 'train' ? t.train : t.bus;
        
        // Get vehicle details for ticket display
        const vehicleDetails = getVehicleDetails(transportType, company.id, from, to);
        
        ticketDisplay.innerHTML = `
            <div class="ticket-print-container">
                <h2 class="ticket-title"><span style="color: black">Gideon</span><span style="color: #ffd700;">Booking</span><br>${t.yourTravelTicket}</h2>
                
                <div class="ticket-header">
                    <div class="ticket-company-section">
                        <div class="ticket-company-banner">
                            ${company.logo ? 
                                `<img src="${company.logo}" alt="${company.name}" style="max-height: 80px; max-width: 100%; object-fit: contain;">` : 
                                `<div style="font-size: 1.5rem; font-weight: bold; color: #1a73e8; text-align: center;">${company.name}</div>`
                            }
                        </div>
                        <div class="ticket-info">
                            <strong>Aina ya Chombo:</strong>
                            <span>${vehicleDetails.planeType || vehicleDetails.busType || vehicleDetails.trainType || 'Standard'}</span>
                        </div>
                    </div>
                    
                    <div class="ticket-ref-section">
                        <div class="ticket-ref-with-barcode">
                            <div class="ref-number">${t.referenceNumber}<br><strong>${bookingRef}</strong></div>
                            <div class="barcode">
                                ${customBarcode}
                            </div>
                            <div class="barcode-instruction">${t.scanBarcode}</div>
                        </div>
                    </div>
                </div>
                
                <div class="ticket-body">
                    <div class="ticket-column">
                        <div class="ticket-info">
                            <strong>${t.from}</strong>
                            <span>${cities[from].name} (${from})</span>
                        </div>
                        <div class="ticket-info">
                            <strong>${t.to}</strong>
                            <span>${cities[to].name} (${to})</span>
                        </div>
                        <div class="ticket-info">
                            <strong>${t.departureDate}</strong>
                            <span>${date}</span>
                        </div>
                        <div class="ticket-info">
                            <strong>${t.departureTime}</strong>
                            <span>${departureTime}</span>
                        </div>
                    </div>
                    
                    <div class="ticket-column">
                        <div class="ticket-info">
                            <strong>${t.transportType}</strong>
                            <span>${transportTypeText}</span>
                        </div>
                        <div class="ticket-info">
                            <strong>${t.company}</strong>
                            <span>${company.name}</span>
                        </div>
                        <div class="ticket-info">
                            <strong>${t.transportNumber.replace('__type__', transportTypeText)}</strong>
                            <span>${window.selectedFlight ? window.selectedFlight.code : 'N/A'}</span>
                        </div>
                        <div class="ticket-info">
                            <strong>${t.tripType}</strong>
                            <span>${flightTypeText}</span>
                        </div>
                        <div class="ticket-info">
                            <strong>${t.seat}</strong>
                            <span>${seat || t.checkIn}</span>
                        </div>
                        <div class="ticket-info">
                            <strong>${t.arrivalTime}</strong>
                            <span>${arrivalInfo.time}</span>
                        </div>
                        <div class="ticket-info">
                            <strong>${t.arrivalDate}</strong>
                            <span>${arrivalInfo.date} ${showDifferentDate ? `<span style="color:#ff9f43">(${t.nextDayNotice.split(':')[0]})</span>` : ''}</span>
                        </div>
                    </div>
                </div>
                
                <div class="ticket-passenger-list">
                    <h3>${t.passengerList} (${passengerCount})</h3>
                    ${passengerListHTML}
                </div>
                
                <div class="ticket-payment-info">
                    <div class="ticket-column">
                        <div class="ticket-info">
                            <strong>${t.totalPayment}</strong>
                            <span>${formatCurrency(parseInt(price) * passengerCount)}</span>
                        </div>
                    </div>
                    
                    <div class="ticket-column">
                        <div class="ticket-info">
                            <strong>${t.contact}</strong>
                            <span>${email}, ${phone}</span>
                        </div>
                    </div>
                </div>
                
                <div class="ticket-footer">
                    <p><strong>${t.thanks.replace('__company__', company.name)}</strong></p>
                    <p><strong>${currentLanguage === 'sw' ? 'Maelekezo:' : 'Instructions:'}</strong> ${t.instructions}</p>
                    ${showDifferentDate ? `<p style="color:#ff9f43; font-weight: bold;"><strong>${currentLanguage === 'sw' ? 'Angalizo:' : 'Notice:'}</strong> ${t.nextDayNotice}</p>` : ''}
                    <p class="print-date">${t.printed} ${today}</p>
                </div>
                
                <button class="print-ticket-btn" onclick="printTicket()">
                    <i class="fas fa-print"></i> ${t.printTicket}
                </button>
            </div>
        `;
        
        ticketDisplay.style.display = 'block';
        document.getElementById('passenger-form').style.display = 'none';
        ticketDisplay.scrollIntoView({ behavior: 'smooth' });
        
        // Save ticket to database simulation
        saveTicketToDatabase(transportType, company, from, to, date, passengers, seat, bookingRef, departureTime);
        
        showLoading(false);
        
        // Show success notification
        showNotification(t.ticketSaved, 'success');
    }

    // Function to save ticket to database
   function saveTicketToDatabase(transportType, company, from, to, date, passengers, seat, bookingRef, departureTime) {
    const passengerCount = parseInt(passengers);
    let passengerData = [];
    
    // Collect passenger data
    for (let i = 1; i <= passengerCount; i++) {
        const name = document.getElementById(`passenger-${i}-name`).value;
        const id = document.getElementById(`passenger-${i}-id`).value;
        const age = document.getElementById(`passenger-${i}-age`).value;
        const gender = document.getElementById(`passenger-${i}-gender`).value;
        
        passengerData.push({ 
            name: name, 
            id: id,
            age: parseInt(age),
            gender: gender
        });
    }
    
    const email = document.getElementById('contact-email').value;
    const phone = document.getElementById('contact-phone').value;
    
    // Generate transport number based on type
    let transportNumber = '';
    let tripType = 'direct';
    
    if (selectedFlight) {
        transportNumber = selectedFlight.code;
        tripType = selectedFlight.isDirect ? 'direct' : 'stopover';
    } else {
        // For bus and train, generate number
        const prefix = transportType === 'bus' ? 'BS' : 'TR';
        transportNumber = `${prefix}${company.id}${Math.floor(100 + Math.random() * 900)}`;
    }
    
    // Ensure departure time exists
    if (!departureTime) {
        departureTime = generateRandomTime(transportType);
    }
    
    const bookingData = {
        transportType: transportType,
        company: {
            id: company.id,
            name: company.name
        },
        from: from,
        to: to,
        date: date,
        passengers: passengerData,
        price: parseInt(selectedPrice),
        seat: seat || 'N/A',
        contactEmail: email,
        contactPhone: phone,
        transportNumber: transportNumber,
        departureTime: departureTime,
        tripType: tripType,
        bookingRef: bookingRef
    };
    
    console.log('Sending booking data:', bookingData);
    
    // Send data to PHP backend
    fetch('save_booking.php', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(bookingData)
    })
    .then(response => response.json())
    .then(data => {
        console.log('Server response:', data);
        if (data.success) {
            showNotification(translations[currentLanguage].ticketSaved, 'success');
        } else {
            showNotification('Error saving ticket: ' + data.message, 'error');
        }
    })
    .catch(error => {
        console.error('Network error:', error);
        showNotification('Network error occurred', 'error');
    });
}

// Helper function to generate random time
function generateRandomTime(transportType) {
    let minHour, maxHour;
    
    switch(transportType) {
        case "flight":
            minHour = 6;
            maxHour = 23;
            break;
        case "train":
            minHour = 5;
            maxHour = 23;
            break;
        case "bus":
            minHour = 4;
            maxHour = 23;
            break;
        default:
            minHour = 6;
            maxHour = 18;
    }
    
    const hours = Math.floor(Math.random() * (maxHour - minHour + 1)) + minHour;
    const minutes = Math.floor(Math.random() * 60);
    
    return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
}
</script>

</body>
</html>